<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 06: Linear Models • ENVS475</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 06: Linear Models">
<meta property="og:description" content="ENVS475">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ENVS475</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2024.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fa fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fa fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-desktop"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/lecture_01/lecture_01.html">Lecture 01: Course introduction</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_03_basic-stats/lecture_03_basic-stats.html">Lecture 03: Basic Statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_05_estimation/lecture_05_estimation.html">Lecture 05: Point Estimates</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_06_intro-models/lecture_06_intro-models.html">Lecture 06: Intro to Models</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_07_t-tests/lecture_07_t-tests.html">Lecture 07: t-tests</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_10_anova/lecture_10_anova.html">Lecture 10: ANOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop-code"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab_01_projects.html">lab 01: projects</a>
    </li>
    <li>
      <a href="../articles/lab_02_intro_to_R.html">lab 02: Intro to R</a>
    </li>
    <li>
      <a href="../articles/lab_03_normal-distributions.html">lab 03: Normal Distributions</a>
    </li>
    <li>
      <a href="../articles/lab_04a_dplyr.html">lab 04a: dplyr</a>
    </li>
    <li>
      <a href="../articles/lab_04b_ggplot.html">lab 04b: ggplot</a>
    </li>
    <li>
      <a href="../articles/lab_05_point-estimates.html">lab 05: point estimates</a>
    </li>
    <li>
      <a href="../articles/lab_06_linear-models.html">lab 06: linear models</a>
    </li>
    <li>
      <a href="../articles/lab_08_t-tests.html">lab 07: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab_07_intro_markdown.html">lab 09: intro to R markdown</a>
    </li>
    <li>
      <a href="../articles/lab_10_anova.html">lab 10: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab_11_factorial-anova.html">lab 11: Factorial ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab_12_2-way-anova.html">lab 12: 2-way anova</a>
    </li>
    <li>
      <a href="../articles/lab_13_linear-regression.html">lab 13: Linear Regression</a>
    </li>
    <li>
      <a href="../articles/lab_14_ANCOVA.html">lab 14: ANCOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-folder-open"></span>
     
    Homework
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework/HW_01.html">Homework 01 setup</a>
    </li>
    <li>
      <a href="../articles/homework/HW_02_intro_R.html">Homework 02 Intro to R</a>
    </li>
    <li>
      <a href="../articles/homework/HW_03_normal-distributions.html">Homework 03 Normal Distributions</a>
    </li>
    <li>
      <a href="../articles/homework/HW_04_dplyr_ggplot.html">Homework 04 dplyr + ggplot2</a>
    </li>
    <li>
      <a href="../articles/homework/HW_05_point-estimates.html">Homework 05 Point Estimates</a>
    </li>
    <li>
      <a href="../articles/homework/HW_06_linear_models.html">Homework 06 Intro to Linear Models</a>
    </li>
    <li>
      <a href="../articles/homework/HW_07_t-tests.html">Homework 07 t-tests</a>
    </li>
    <li>
      <a href="../articles/homework/HW_09_markdown.html">Homework 09 R Markdown</a>
    </li>
    <li>
      <a href="../articles/homework/HW_10_ANOVA.html">Homework 10 ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_11_factorial.html">Homework 11 Factorial ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_12_two-way-ANOVA.html">Homework 12 2-way ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_13_linear-regression.html">Homework 13 Linear Regression</a>
    </li>
    <li>
      <a href="../articles/homework/HW_14_ANCOVA.html">Homework 14 ANCOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/term-list.html">Terms and Definitions</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 06: Linear Models</h1>
            <h3 data-toc-skip class="subtitle">ENVS475: Experimental
Analysis and Design</h3>
            
            <h4 data-toc-skip class="date">Spring, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Jpomz/ENVS475/blob/HEAD/vignettes/articles/lab_06_linear-models.Rmd" class="external-link"><code>vignettes/articles/lab_06_linear-models.Rmd</code></a></small>
      <div class="hidden name"><code>lab_06_linear-models.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="about">About<a class="anchor" aria-label="anchor" href="#about"></a>
</h2>
<p>This lab introduces the analysis of data using a linear model
framework. It closely follows chapter 6 in <em>The New Statistics With
R</em> 2nd ed. by Andy Hector.</p>
<div class="section level4">
<h4 id="packages">Packages<a class="anchor" aria-label="anchor" href="#packages"></a>
</h4>
<p>For this lab, we will be using the <code>dplyr</code>,
<code>ggplot2</code>, and <code>arm</code> packages. Make sure all
packages are installed on your computer, and then run the following
code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=arm" class="external-link">arm</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>For this lab, we will be using data from an experiment that Charles
Darwin performed on the effects of self-pollination on <em>Zea
maize</em> plants. Darwin was interested in determining if high genetic
diversity also led to more healthy plants, and it is assumed that
self-pollinated plants will have lower genetic diversity Briefly, Darwin
was interested in whether or not there was a difference in fitness of
seeds which were produced from self- or cross-pollinated plants. Here,
the height of the plants was used as a surrogate for fitness.</p>
<p>We will be using the <code>darwin_maize.csv</code> data, which you
can download from D2L. Be sure to put it into your <code>data/</code>
folder. When we read in the data, we will assign it to the object called
<code>darwin_maize</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">darwin_maize</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"data/darwin_maize.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s take a brief look at the data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">darwin_maize</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "pot"    "pair"   "type"   "height"</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">darwin_maize</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 30  4</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">darwin_maize</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   pot pair  type height</span></span>
<span><span class="co">## 1   I    1 Cross 23.500</span></span>
<span><span class="co">## 2   I    1  Self 17.375</span></span>
<span><span class="co">## 3   I    2 Cross 12.000</span></span>
<span><span class="co">## 4   I    2  Self 20.375</span></span>
<span><span class="co">## 5   I    3 Cross 21.000</span></span>
<span><span class="co">## 6   I    3  Self 20.000</span></span></code></pre>
<ul>
<li>This data contains 30 observations in 4 columns.<br>
</li>
<li>The variables we are concerned with are the <code>type</code> and
<code>height</code><br>
</li>
<li>The <code>pot</code> and <code>pair</code> variables are grouping
variables which we will ignore for now but will discuss in a future
lab.</li>
</ul>
<p>You can check to see which values appear in the <code>type</code>
variable with the following code. Note that these return the same values
but in different formats.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">darwin_maize</span>, <span class="va">type</span><span class="op">)</span> <span class="co"># returns data frame</span></span></code></pre></div>
<pre><code><span><span class="co">##    type</span></span>
<span><span class="co">## 1 Cross</span></span>
<span><span class="co">## 2  Self</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">darwin_maize</span><span class="op">$</span><span class="va">type</span><span class="op">)</span> <span class="co"># returns a vector</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Cross" "Self"</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="linear-models">Linear Models<a class="anchor" aria-label="anchor" href="#linear-models"></a>
</h2>
<p>Before, we calculated means, standard deviations, and standard error
of the means by hand or with <code>dplyr</code> functions
(<code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code>). Now, we are going
to adopt a linear model approach and use the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function
(lm stands for “linear model”).</p>
<p>In the most basic case, we can use the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> to calculate
an “intercept-only” model. Essentially this is just calculating the
grand mean of our response variable within the data. Before we get into
the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function, let’s plot our response variable. We are
going to ignore the grouping variables, and here we will set
<code>x = 0</code> to illustrate the “intercept-only” aspect:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">darwin_maize</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">height</span>,</span>
<span>           x <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_06_linear-models_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>We can see there’s lots of variation in the observations
(<em>y-axis</em>). Our estimate for the global intercept will just be
the average response of these data points.</p>
<div class="section level3">
<h3 id="intercept-only-model-with-lm">Intercept-only model with <code>lm()</code><a class="anchor" aria-label="anchor" href="#intercept-only-model-with-lm"></a>
</h3>
<p>Now let’s use the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function to calculate a linear
model. The <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function is a bit different from most of
the functions we’ve seen so far. Namely, the first argument it takes is
a <code>formula</code>, and we need to specify the object we want to
perform the model on with the <code>data</code> argument. Likewise, the
output it returns is a special type of <code>list</code> called an
<code>lm</code>, so we will need to store the output in a new
object.</p>
<p>I’m going to call this object <code>dlm0</code> which stands for
“darwin linear model 0”.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlm0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">height</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>           data <span class="op">=</span> <span class="va">darwin_maize</span><span class="op">)</span></span></code></pre></div>
<p>The first argument is a formula. It has the general syntax of
<code>response_variable ~ predictor_variable</code>. Here, the response
we’re interested in is <code>height</code>. For this simple model, we
are ignoring all predictor variables and just calculating an intercept.
However, R doesn’t know how to deal with an incomplete formula, so we
put a <code>1</code> in as a place holder.</p>
<p>The new object we created is a list. Lists are complex data
structures which can hold many different types of data. We will get into
the specifics of these later, but for now just run the following code to
get an idea of the general structure of the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>
output.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">dlm0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">dlm0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "lm"</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dlm0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "coefficients"  "residuals"     "effects"       "rank"         </span></span>
<span><span class="co">##  [5] "fitted.values" "assign"        "qr"            "df.residual"  </span></span>
<span><span class="co">##  [9] "call"          "terms"         "model"</span></span></code></pre>
<p>Because the output is a complex data type, we will rely on a special
function to summarize the output and give us the values we are
interested in for now. (In the future we will be interested in other
values, such as p-values, so will use different functions later.)</p>
<p>We will use the <code><a href="https://rdrr.io/pkg/arm/man/display.html" class="external-link">display()</a></code> function from the
<code>arm</code> package. Make sure you ran the
<code><a href="https://CRAN.R-project.org/package=arm" class="external-link">library(arm)</a></code> call at the top of this lab. If you try and
run the code below and get an error, it’s likely that the package was
not properly installed or loaded.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/arm/man/display.html" class="external-link">display</a></span><span class="op">(</span><span class="va">dlm0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## lm(formula = height ~ 1, data = darwin_maize)</span></span>
<span><span class="co">##             coef.est coef.se</span></span>
<span><span class="co">## (Intercept) 18.88     0.58  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## n = 30, k = 1</span></span>
<span><span class="co">## residual sd = 3.18, R-Squared = 0.00</span></span></code></pre>
<p>This output is called a <em>table of coefficients</em>. There is a
row for each coefficient (in this case, just the intercept) and the
columns show the estimate as well as the standard error of the
estimate.</p>
<p>Coefficient tables in R always list the first coefficient as the
intercept, and it can be sometimes tricky to figure out what it’s
actually referring to. In this case, we can confirm it’s the global
average by using the <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code> function, either on it’s own or
with <code>dplyr</code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">darwin_maize</span><span class="op">$</span><span class="va">height</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 18.88333</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">darwin_maize</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>global_avg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">height</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   global_avg</span></span>
<span><span class="co">## 1   18.88333</span></span></code></pre>
<p>The number of observations is displayed in the table of coefficients
as <code>n</code>, and the number of parameters estimated is shown with
<code>k</code>. It also shows us the <span class="math inline">\(R^2\)</span> value, tells us how much variation is
explained based on the predictor variables used in our model. <span class="math inline">\(R^2\)</span> values range from 1 (perfect
explanation) to 0 (no explanation). In this case we don’t have any
predictor variables, so the intercept only model explains 0% of the
variation in the response variable.</p>
<p>The table also shows us the residual standard deviation, which in
this case is the same as using <code><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd()</a></code> since we are ignoring
group-levels.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">darwin_maize</span><span class="op">$</span><span class="va">height</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3.180953</span></span></code></pre>
<div class="section level4">
<h4 id="you-should-now-be-able-to-complete-problem-1-in-the-homework-assignment">
<strong>You should now be able to complete problem 1 in the homework
assignment</strong><a class="anchor" aria-label="anchor" href="#you-should-now-be-able-to-complete-problem-1-in-the-homework-assignment"></a>
</h4>
</div>
</div>
<div class="section level3">
<h3 id="model-with-a-categorical-predictor">Model with a categorical predictor<a class="anchor" aria-label="anchor" href="#model-with-a-categorical-predictor"></a>
</h3>
<p>The intercept-only model is useful for showing what the
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function does but is rarely of interest in an analysis
framework. Let’s examine a slightly more complex model where we use the
<code>type</code> variable as a predictor.</p>
<p>But first, let’s plot the data separated by <code>type</code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">darwin_maize</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">type</span>, </span>
<span>           y <span class="op">=</span> <span class="va">height</span>, </span>
<span>           color <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_06_linear-models_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>We can now see that the plants which are categorized as
<code>type == Cross</code> may be taller than the
<code>type == Self</code> category. Remember that the <code>Self</code>
plants presumably have lower genetic diversity. This plot looks to
confirm the general hypothesis, but let’s make one small tweak to the
plot in order to show all the individual observations.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">darwin_maize</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">type</span>, </span>
<span>           y <span class="op">=</span> <span class="va">height</span>, </span>
<span>           color <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span></span>
<span>               width <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>               height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_06_linear-models_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>The <code>poisiotion_jitter()</code> function adds a little bit of
random noise to the points so that they are note plotted right over one
another (note that there are now 2 observations in the Cross group at
the y-value of 12). In this case, we added a little noise to the x-axis
(<code>width = 0.1</code>). Because the y-axis is our response variable,
we did not add any noise (<code>height = 0</code>) to it to avoid
masking the effect of our predictor variable.</p>
<p>Now, let’s fit the model including the categorical predictor variable
into a new object <code>dlm1</code> (darwin linear model 1).</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">type</span>,</span>
<span>           data <span class="op">=</span> <span class="va">darwin_maize</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note</strong> that when you have predictor variables in the
formula the <code>1</code> is no longer needed, so running
<code>lm(height ~ type, data = darwin_maize)</code> will give you the
same result.</p>
<p>Let’s display the results of our new model:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/arm/man/display.html" class="external-link">display</a></span><span class="op">(</span><span class="va">dlm1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## lm(formula = height ~ 1 + type, data = darwin_maize)</span></span>
<span><span class="co">##             coef.est coef.se</span></span>
<span><span class="co">## (Intercept) 20.19     0.76  </span></span>
<span><span class="co">## typeSelf    -2.62     1.07  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## n = 30, k = 2</span></span>
<span><span class="co">## residual sd = 2.94, R-Squared = 0.18</span></span></code></pre>
<p>The layout of this table is similar as before, but now we have two
rows, one called “(Intercept)” and one called “typeSelf”. Recall that
there are only 2 categories in the <code>type</code> variable. Because
typeSelf is listed in the table, you would be correct in assuming that
(Intercept) is the average height of the plants in the Cross group.</p>
<p>You might also assume that the <code>typeSelf</code> coefficient
estimate is the avergae of the other group of plants. However, this
coefficient is showing the estimated <em>difference</em> in means. So in
order to get the mean for the Self group, we need to subtract the
estimated difference from the estimate for the Cross group.</p>
<p><span class="math display">\[ \bar{y}_{self} = \bar{y}_{cross} -
\beta_{difference}\]</span></p>
<p><span class="math display">\[\bar{y}_{self} = 20.19 - 2.62 =
17.57\]</span></p>
<div class="float">
<img src="box_6-1.jpg" alt="box 6.1 from New Statistics"><div class="figcaption">box 6.1 from New Statistics</div>
</div>
<p>We can add estimates of the group means in ggplot to help us
visualize this.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">darwin_maize</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">type</span>, </span>
<span>           y <span class="op">=</span> <span class="va">height</span>, </span>
<span>           color <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span></span>
<span>               width <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>               height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, </span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>               shape <span class="op">=</span> <span class="fl">8</span>, </span>
<span>               size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_06_linear-models_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p><strong>You should now be able to complete problem 2 in the homework
assignment.</strong></p>
</div>
<div class="section level3">
<h3 id="standard-error-of-the-difference">Standard error of the difference<a class="anchor" aria-label="anchor" href="#standard-error-of-the-difference"></a>
</h3>
<p>The coefficient table above contains estimates of our coefficients as
well as standard errors. The standard error for the intercept is
calculated the same was the SEM we saw before in class: <span class="math inline">\(SEM = \frac{\sigma}{\sqrt n}\)</span>.</p>
<p>The standard error for the second term is not an SEM but a standard
error of the difference between means (SED). The formula for this
is:</p>
<p><span class="math display">\[\large SED = \sqrt{\frac{s^2_{1}}{n_1} +
\frac{s^2_{2}}{n_2}}\]</span></p>
<p>However, the linear model doesn’t calculate the variance from each
group separately but does a more accurate “pooled” calculation. I won’t
ask you yo do this manually in class, but just know that if you used
<code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var()</a></code> on each group and tried to plug it into the formula
above you would not get exactly the same result.</p>
<p>The SED is always wider than the SEM of either group. This is because
there is uncertainty in the estimate of each group mean (SEM), and these
uncertainties are carried through the calculation of the difference
between the means.</p>
</div>
<div class="section level3">
<h3 id="confidence-intervals-of-coefficients">Confidence intervals of coefficients<a class="anchor" aria-label="anchor" href="#confidence-intervals-of-coefficients"></a>
</h3>
<p>Recall that a 95% CI is approximated by:</p>
<p><span class="math display">\[\large 95\% CI = \bar{y} \pm
2*SEM\]</span> Similar to the SED calculation above, there is
uncertainty in our estimates, our SEM and SED’s so we cannot simply
multiply these together to estimate a 95% CI. Luckily, there is an R
function, <code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> which specifically calculates
confidence intervals for coefficients from linear models. <strong>This
function does not work on vectors. It only works on fitted model
objects</strong></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">dlm1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                2.5 %     97.5 %</span></span>
<span><span class="co">## (Intercept) 18.63651 21.7468231</span></span>
<span><span class="co">## typeSelf    -4.81599 -0.4173433</span></span></code></pre>
<p>The output of <code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> is the lower bound (2.5%) and
the upper bound (97.5%) of the confidence interval.</p>
<p>So the 95% confidence interval for the average height of the Cross
plants is: 18.6365102, 21.7468231, and the 95% CI for the average
difference between the two groups is: -4.81599, -0.4173433.</p>
<div class="section level4">
<h4 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h4>
<p>Recall that the hypothesis was that self-pollinating plants were less
fit due to lower genetic diversity. What does our data indicate?</p>
<p>If there was <strong>NO EFFECT</strong> of self-pollination, we would
expect the heights of each group to be the same. Or in other words, the
difference between the groups would be 0. Because the 95% CI is
completely negative (does not include 0), we can be fairly confident
that there is a difference in plant height. Because the mean height of
the Self-group of plants is lower, we can conclude the difference in
height is consistent with the original hypothesis (self-pollinated
plants are shorter and therefore less-fit).</p>
<p>The <code>arm</code> package has a nice function for displaying
coefficient estimates: <code><a href="https://rdrr.io/pkg/arm/man/coefplot.html" class="external-link">coefplot()</a></code>. This function also
requires the object to be a model fit (will not work on a vector).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/arm/man/coefplot.html" class="external-link">coefplot</a></span><span class="op">(</span><span class="va">dlm1</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_06_linear-models_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>I added the <code>xlim = c(-5, 0)</code> argument to ensure that the
plot displayed 0, which is our value of interest. When you’re doing this
on the homework, you may need to play around with different limits on
the x-axis.</p>
<p>So, at the 95% confidence level, we can say that the there is a
decrease in mean plant height in self-pollinated plants.</p>
<p>We can test this same hypothesis at a higher level of confidence,
i.e., 99% CI</p>
</div>
<div class="section level4">
<h4 id="ci-and-coefplot">99% CI and <code>coefplot()</code><a class="anchor" aria-label="anchor" href="#ci-and-coefplot"></a>
</h4>
<p>We can change the level of certainty in both the
<code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> and <code><a href="https://rdrr.io/pkg/arm/man/coefplot.html" class="external-link">coefplot()</a></code> functions with the
following. We can calculate a 99% CI directly by adding
<code>level = 0.99</code> to the <code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> function.
Unfortunately, the <code><a href="https://rdrr.io/pkg/arm/man/coefplot.html" class="external-link">coefplot()</a></code> function only allows us to
change the level of standard deviation. We can set <code>sd = 3</code>
to get <em>approximately</em> the same values.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">dlm1</span>, level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                 0.5 %     99.5 %</span></span>
<span><span class="co">## (Intercept) 18.093790 22.2895433</span></span>
<span><span class="co">## typeSelf    -5.583512  0.3501789</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/arm/man/coefplot.html" class="external-link">coefplot</a></span><span class="op">(</span><span class="va">dlm1</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_06_linear-models_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>Notice that at the 99% confidence level (or at 3 * the standard
deviation), the interval now crosses 0. In other words, at this more
strict level of confidence, we cannot say that there is a difference in
height between the two plant groups.</p>
</div>
<div class="section level4">
<h4 id="you-should-now-be-able-to-complete-problem-3-in-the-homework-assignment-">
<strong>You should now be able to complete problem 3 in the homework
assignment. </strong><a class="anchor" aria-label="anchor" href="#you-should-now-be-able-to-complete-problem-3-in-the-homework-assignment-"></a>
</h4>
</div>
</div>
</div>
<div class="section level2">
<h2 id="assumptions">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions"></a>
</h2>
<p>It’s always important to remember that all models have assumptions,
and you should check that those assumptions are reasonably met. The 4
assumptions of a linear model are:</p>
<ol style="list-style-type: decimal">
<li>Linearity<br>
</li>
<li>Normality of residuals<br>
</li>
<li>Equal variance (homoscedasticity) of residuals<br>
</li>
</ol>
<ul>
<li>For categorical data, need to ensure equal variance across
groups</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Independence</li>
</ol>
<p>Assumption 1 is usually assessed graphically and will be more
important when we get to regression analysis (continuous x-variables).
For categorical data it is less often tested directly.</p>
<p>Testing assumption 4 directly is tough, so usually we assess this
assumption based on our understanding of how the data were generated and
observed.</p>
<p>For assumptions 2 and 3, even with categorical data, we can assess
with graphs.</p>
<p>For assumption 2, normal distribution of residuals, we use a Q-Q plot
which shows our standardized residuals compared with our theoretical
quantiles. We can do this using <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code>.
<strong>NOTE</strong> the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> function has an argument
called <code>sample</code>. We do not use an x or y argument.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">darwin_maize</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">stat_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># plot qq points</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">stat_qq_line</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># reference line</span></span></code></pre></div>
<p><img src="lab_06_linear-models_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>If the residuals were perfectly normal, all the points would be
exactly on the line. Here, the data in the middle fit pretty well, but
the observations at the extreme ends are rather far off the line.
Luckily, linear models are fairly robust to this assumption. In this
case, it doesn’t look perfect, but it’s not terrible. We will discuss
how to deal with non-normal residuals in the future.</p>
<p>For assumption 3, equal variance of residuals, we can compare the
fitted model values with the residuals. For this we can again use
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code>, however, this time we are plotting the model
object, not the raw data directly. Note that I once again added a
“jitter” argument to the width (x-axis) to help visualize the individual
points but did not modify the position on the height (y-axis)</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dlm1</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.fitted</span>, y <span class="op">=</span> <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>      position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span></span>
<span>        width <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>        height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_06_linear-models_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>What we are looking for here is that the minimum and maximum y-values
are the same across the x-values, and that they are approximately
equally distributed above and below the reference line (y = 0).</p>
<p>Here, we have a few points that are well below the rest (difference
in range), and it appears to be unequal (most points above the 0
reference line). Similar to the results above, this is not perfect, but
also not terrible.</p>
<p>When we have categorical predictors, we also want to ensure that the
variance between groups is approximately the same. We can do this with a
boxplot of the groups.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">darwin_maize</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">height</span>,</span>
<span>           y <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Example of approx. equal variances across groups"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_06_linear-models_files/figure-html/unnamed-chunk-20-1.png" width="700">
Here, the widths of the boxplots are approximately equal which means
that each group has approximately the same observed variation. The dots
on the left side for each group are not ideal, but this doesn’t look too
concerning.</p>
<p>What would be concerning is if the widths of the boxes were different
sizes. For example:</p>
<p><img src="lab_06_linear-models_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<div class="section level4">
<h4 id="you-should-now-be-able-to-complete-problem-4-in-the-homework-assignment-">
<strong>You should now be able to complete problem 4 in the homework
assignment. </strong><a class="anchor" aria-label="anchor" href="#you-should-now-be-able-to-complete-problem-4-in-the-homework-assignment-"></a>
</h4>
</div>
<div class="section level3">
<h3 id="relevelling-the-groups">Relevelling the groups<a class="anchor" aria-label="anchor" href="#relevelling-the-groups"></a>
</h3>
<p>We can modify the data to estimate the mean and SE for the other
plant group (<code>Self</code>). Right now, the <code>type</code> column
is a character datatype.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">darwin_maize</span><span class="op">$</span><span class="va">type</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "character"</span></span></code></pre>
<p>The default behavior for R is to treat characters alphabetically. We
can change this by setting the class of <code>type</code> to a factor
and designate the levels or orders of that factor. I will first make a
new object called <code>darwin_factor</code>, which will be an exact
copy of <code>darwin_maize</code>. I will then change the class of the
<code>type</code> variable directly.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># copy the data object</span></span>
<span><span class="va">darwin_factor</span> <span class="op">&lt;-</span> <span class="va">darwin_maize</span></span>
<span></span>
<span><span class="co"># change the class of the type column</span></span>
<span><span class="co"># and set the levels</span></span>
<span><span class="va">darwin_factor</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>  <span class="va">darwin_factor</span><span class="op">$</span><span class="va">type</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Self"</span>, <span class="st">"Cross"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># what is the class of the new type column?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">darwin_factor</span><span class="op">$</span><span class="va">type</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "factor"</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># what are the order of the levels?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">darwin_factor</span><span class="op">$</span><span class="va">type</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Self"  "Cross"</span></span></code></pre>
<p>Finally, we can perform the same linear model analysis as above with
the <code>Self</code> group as our reference level.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/arm/man/display.html" class="external-link">display</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">height</span><span class="op">~</span><span class="va">type</span>, data <span class="op">=</span> <span class="va">darwin_factor</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## lm(formula = height ~ type, data = darwin_factor)</span></span>
<span><span class="co">##             coef.est coef.se</span></span>
<span><span class="co">## (Intercept) 17.58     0.76  </span></span>
<span><span class="co">## typeCross    2.62     1.07  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## n = 30, k = 2</span></span>
<span><span class="co">## residual sd = 2.94, R-Squared = 0.18</span></span></code></pre>
<p>Now we can see that the estimate and SE for the Intercept coefficient
are different. Likewise the second row of the table now says
<code>typeCross</code> instead of <code>typeSelf</code>.</p>
<div class="section level4">
<h4 id="coda">Coda<a class="anchor" aria-label="anchor" href="#coda"></a>
</h4>
<p>You should now be able to complete the homework for introduction to
linear models.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Justin Pomeranz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 03: Normal Distributions • ENVS475</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 03: Normal Distributions">
<meta property="og:description" content="ENVS475">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ENVS475</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2025.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fa fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fa fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-desktop"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/lecture_01/lecture_01.html">Lecture 01: Course introduction</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_03_basic-stats/lecture_03_basic-stats_2025.html">Lecture 03: Basic Statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_05_estimation/lecture_05_estimation.html">Lecture 05: Point Estimates</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_06_intro-models/lecture_06_intro-models.html">Lecture 06: Intro to Models</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_07_t-tests/lecture_07_t-tests.html">Lecture 07: t-tests</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_09_tidy/lecture_09_tidy.html">Lecture 09: Tidy</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_10_anova/lecture_10_anova.html">Lecture 10: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_11_factorial/lecture_11_factorial_anova.pdf">Lecture 11: Factorial</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_12_two-way/lecture_12_two-way.pdf">Lecture 12: Factorial</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_13_regression/lecture_13_regression.pdf">Lecture 13: Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop-code"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab_01_projects.html">lab 01: projects</a>
    </li>
    <li>
      <a href="../articles/lab_02_intro_to_R.html">lab 02: Intro to R</a>
    </li>
    <li>
      <a href="../articles/lab_03_normal-distributions.html">lab 03: Normal Distributions</a>
    </li>
    <li>
      <a href="../articles/lab_04a_dplyr.html">lab 04a: dplyr</a>
    </li>
    <li>
      <a href="../articles/lab_04b_ggplot.html">lab 04b: ggplot</a>
    </li>
    <li>
      <a href="../articles/lab_05_point-estimates.html">lab 05: point estimates</a>
    </li>
    <li>
      <a href="../articles/lab_06_linear-models.html">lab 06: linear models</a>
    </li>
    <li>
      <a href="../articles/lab_08_t-tests.html">lab 07: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab_09_tidy-data-entry.html">lab 09: Tidy Data Entry</a>
    </li>
    <li>
      <a href="../articles/lab_10_anova.html">lab 10: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab_11_factorial-anova.html">lab 11: Factorial ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab_12_2-way-anova.html">lab 12: 2-way anova</a>
    </li>
    <li>
      <a href="../articles/lab_13_linear-regression.html">lab 13: Linear Regression</a>
    </li>
    <li>
      <a href="../articles/lab_14_ANCOVA.html">lab 14: ANCOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-folder-open"></span>
     
    Homework
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework/HW_01.html">Homework 01 setup</a>
    </li>
    <li>
      <a href="../articles/homework/HW_02_intro_R.html">Homework 02 Intro to R</a>
    </li>
    <li>
      <a href="../articles/homework/HW_03_normal-distributions.html">Homework 03 Normal Distributions</a>
    </li>
    <li>
      <a href="../articles/homework/HW_04_dplyr_ggplot.html">Homework 04 dplyr + ggplot2</a>
    </li>
    <li>
      <a href="../articles/homework/HW_05_point-estimates.html">Homework 05 Point Estimates</a>
    </li>
    <li>
      <a href="../articles/homework/HW_06_linear_models.html">Homework 06 Intro to Linear Models</a>
    </li>
    <li>
      <a href="../articles/homework/HW_07_t-tests.html">Homework 07 t-tests</a>
    </li>
    <li>
      <a href="../articles/homework/HW_09_tidy.html">Homework 09 Tidy</a>
    </li>
    <li>
      <a href="../articles/homework/HW_10_ANOVA.html">Homework 10 ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_11_factorial.html">Homework 11 Factorial ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_12_two-way-ANOVA.html">Homework 12 2-way ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_13_linear-regression.html">Homework 13 Linear Regression</a>
    </li>
    <li>
      <a href="../articles/homework/HW_14_ANCOVA.html">Homework 14 ANCOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/term-list.html">Terms and Definitions</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 03: Normal Distributions</h1>
                        <h4 data-toc-skip class="author">Justin
Pomeranz</h4>
            
            <h4 data-toc-skip class="date">January, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Jpomz/ENVS475/blob/HEAD/vignettes/articles/lab_03_normal-distributions.Rmd" class="external-link"><code>vignettes/articles/lab_03_normal-distributions.Rmd</code></a></small>
      <div class="hidden name"><code>lab_03_normal-distributions.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="why-do-we-care-about-how-numbers-are-distributed">Why do we care about how numbers are distributed?<a class="anchor" aria-label="anchor" href="#why-do-we-care-about-how-numbers-are-distributed"></a>
</h2>
<p>Let’s stop and take a step back. What is the purpose of statistics?
Well, there’re lots of reasons for statistics. But the one that I most
often think of is “what should we expect to see when we measure
something?” What values are normal (expected)? What values are
<em>unexpected</em>? When we measure things there is often lots of
<em>noise</em> or variation in the values we get. But somewhere, buried
in that noise is the <em>signal</em>. Most often, we are interested in
detecting the signal.</p>
<p>Let’s take an example. If I asked you what the average height of a
human being is, you’d probably have an answer. Maybe somewhere between
5’6” and 5’10” (167-178 cm) depending on if you were thinking about
averages within or among the sexes. Perhaps you’re estimate would be
slightly different if you were from a place where most people are taller
or shorter than the average. However, I’m willing to bet (and I’m not
even a betting man) that you <em>didn’t</em> say the average around the
world was 4 or 7 feet (122 or 213 cm). Meeting an individual who is 4 or
7 feet may not be overly surprising, but meeting someone who was 2 or 10
feet (61 or 305 cm) would likely be very surprising (excepting of course
children on the low end of the scale).</p>
<p>This is where understanding how numbers are distributed comes in
really handy. All of us probably have a decent idea of how tall we would
expect a new person we meet would be. We might not know <em>exactly</em>
how tall a new acquaintance will be, but there are certain heights which
would surprise us.</p>
<p>This is essentially true for anything we might want to measure: the
number of plants in a field; the biomass of trees in a forest; the
amount of CO<sub>2</sub> emitted from burning a gallon of gas. Most of
us probably have very little idea of what we should expect if we
measured these. If you burned a gallon of gas and measured 10,000 grams
of Carbon, would you be surprised? Flabbergasted? Pretty chill about
it?</p>
</div>
<div class="section level2">
<h2 id="describing-the-normal-distribution">Describing the Normal Distribution<a class="anchor" aria-label="anchor" href="#describing-the-normal-distribution"></a>
</h2>
<p>The normal distribution, also called a Gaussian distribution, or the
“bell curve” is probably somewhat familiar to you. It is a symmetric
distribution that is centered near the mean (AKA average). The mean is
generally represented with the greek letter <span class="math inline">\(\mu\)</span> (mu). <span class="math inline">\(\mu\)</span> determines where on the number line a
given normal distribution falls. For example, here are four identical
normal distributions which only vary in their means, or where they occur
on the number line:</p>
<p><img src="lab_03_normal-distributions_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>How wide the bell curve is is described by its standard deviation.
The standard deviation is generally represented with the greek letter
<span class="math inline">\(\sigma\)</span> (sigma). In the previous
example the standard deviations were all identical. The following graph
shows two normal distributions with identical means, but with different
standard deviations.</p>
<p><img src="lab_03_normal-distributions_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>We describe normal distributions with the following mathematical
notation:</p>
<p><span class="math display">\[\Large X \sim \text{Normal} (\mu,~
\sigma)\]</span></p>
<p>The way you would read this is “x is normally distributed with a mean
of mu and a standard deviation of sigma”.</p>
<p>Note that <span class="math inline">\(Normal()\)</span> in the
equation above is sometimes abbreviated to <span class="math inline">\(N()\)</span>.</p>
<p>The above example shows the general format of writing out a normal
distribution. We usually specify the value of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> when it is known. For example,
here is how we would write it out the distribution for a variable <span class="math inline">\(y\)</span> with a a mean of 65 and a standard
deviation of 10:</p>
<p><span class="math display">\[\Large y \sim \text{N} (\mu = 65,~
\sigma = 10)\]</span></p>
</div>
<div class="section level2">
<h2 id="density-plots-and-probability">Density plots and probability<a class="anchor" aria-label="anchor" href="#density-plots-and-probability"></a>
</h2>
<p>When we are looking at density plots, one of the main things we’re
looking for is how likely or unlikely are a give</p>
</div>
<div class="section level2">
<h2 id="the-empirical-rule">The Empirical Rule<a class="anchor" aria-label="anchor" href="#the-empirical-rule"></a>
</h2>
<p>Another important aspect of the standard deviation, is that multiples
of it describe where different majorities of the data lie. For example,
the mean + and - 1 standard deviation contains about 68% of the total
observations (<span class="math inline">\(\mu \pm \sigma\)</span>).
Likewise, 95% of the observations are within 2 standard deviations
(<span class="math inline">\(\mu \pm 2\sigma\)</span>) and 99.7% are
within 3 standard deviations (<span class="math inline">\(\mu \pm
3\sigma\)</span>). This is called the Empirical Rule and can be
represented in a graph as so:</p>
<div class="float">
<img src="68-95-997.png" style="width:70.0%" alt="Figure 3. The Empirical Rule. (image credit Open Intro Statistics)"><div class="figcaption">Figure 3. The Empirical Rule. (image credit Open
Intro Statistics)</div>
</div>
<p>When working with normal distribution problems, one of the first
things you should do is sketch a graph. Draw a bell curve on a number
line. Make sure to center the curve at the mean, and then write out a
couple of standard deviations to either side. For example, if we have a
normal distribution with <code>mean = 10</code> and <code>sd = 2</code>,
you should immediately draw out something like this:</p>
<div class="float">
<img src="sketch.png" alt="Figure 4. Rough sketch of a normal distribution of mean = 10 and sd = 2"><div class="figcaption">Figure 4. Rough sketch of a normal distribution
of mean = 10 and sd = 2</div>
</div>
<p>The curve is centered at our mean of 10 (tallest part of the “bell”),
and I added a few marks indicating 1 and 2 standard deviations away from
the mean: <span class="math inline">\(10 \pm 2 = (8, 12)\)</span> and
<span class="math inline">\(10 \pm 2*2 = (6, 14)\)</span>.</p>
<p>Then, you can quickly sketch where a give observation would fall on
the distribution. For example, if we had an observation of 9.7 and 13, I
would quickly add them to the sketch:</p>
<div class="float">
<img src="sketch-obs.png" alt="Figure 5. Sketch with observations"><div class="figcaption">Figure 5. Sketch with observations</div>
</div>
<p>Doing this can be a quick estimate of where the observations fall,
and can help us to check our answers (more below).</p>
</div>
<div class="section level2">
<h2 id="co2-from-a-gallon-of-gas">CO<sub>2</sub> from a gallon of gas<a class="anchor" aria-label="anchor" href="#co2-from-a-gallon-of-gas"></a>
</h2>
<p>Let’s return to our example of measuring 10,000 grams of
CO<sub>2</sub> from burning 1 gallon of gas. Let’s say that the grams of
CO<sub>2</sub> from 1 gallon of gas can be described as being normally
distributed with a mean of 8887, and a standard deviation of 500 <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<p>Mathematically, we would write this as: <span class="math display">\[\large CO_{2} \sim {Normal}(\mu = 8,887,~ \sigma
= 500)\]</span></p>
<p>Using this information, let’s apply the empirical rule to quickly
write out the values that bound 68% of the data. Recall that 68% of the
data falls within 1 SD of the mean. In R we could calculate this in a
couple of different ways::</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># lower bound; mean - sd</span></span>
<span><span class="fl">8887</span> <span class="op">-</span> <span class="fl">500</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 8387</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># upper bound; mean + sd</span></span>
<span><span class="fl">8887</span> <span class="op">+</span> <span class="fl">500</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 9387</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># combine it in one line using c()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8887</span> <span class="op">-</span> <span class="fl">500</span>, <span class="fl">8887</span> <span class="op">+</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 8387 9387</span></span></code></pre>
<p>A graph of the full distribution would look something like this (note
that I’m switching to graphics made in R for accuracy, but when you are
working on problems a quick sketch by hand can do wonders)</p>
<p><img src="lab_03_normal-distributions_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Now, let’s add an arrow to show where our measurement of 10,000
lands:</p>
<p><img src="lab_03_normal-distributions_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Based on this information, we might think that an observation of
10,000 grams of CO<sub>2</sub> might be pretty unlikely. We can go a
step further, however, and measure the exact probability of getting a
measurement at this magnitude.</p>
<p>For this, we can use some functions built in to R to describe the
normal distribution. These functions are <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm()</a></code>,
<code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm()</a></code> and <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm()</a></code>.</p>
<div class="section level4">
<h4 id="endnotes">Endnotes<a class="anchor" aria-label="anchor" href="#endnotes"></a>
</h4>
</div>
</div>
<div class="section level2">
<h2 id="normal-distribution-functions">Normal Distribution functions<a class="anchor" aria-label="anchor" href="#normal-distribution-functions"></a>
</h2>
<p>Notice that all three functions have the form of <code>_norm()</code>
which indicates that we are working with a normal distribution. There
are functions for other distributions, which we may get to later this
semester. The <code>_</code> is either a <code>p</code>, <code>d</code>,
or <code>q</code>, which gives us different functions of the normal
distribution according to the following:</p>
<ul>
<li><p><code>d</code> = density function</p></li>
<li><p><code>p</code> = probability distribution function</p></li>
<li><p><code>q</code> = quantile function</p></li>
</ul>
<p>Each of these are used to answer a specific question.</p>
<ul>
<li><p><code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm()</a></code>: what is the probability of sampling a
specific number?</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm()</a></code>: what is the probability of sampling <em>up
to</em> a specific number?</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm()</a></code>: what number represents a specific quantile
of the data?</p></li>
</ul>
<div class="section level3">
<h3 id="probability-of-an-exact-number-dnorm">Probability of an <em>exact</em> number: <code>dnorm()</code><a class="anchor" aria-label="anchor" href="#probability-of-an-exact-number-dnorm"></a>
</h3>
<p>So, what is the probability of measuring exactly 10,000 from our
distribution? To do this, we use the <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm()</a></code> function. the
first argument is the number that we are interested in
<code>10000</code>. The next two arguments are named, and they are where
we describe what type of normal distribution we are working with. Recall
above that we said this normal distribution is described by
<code>mean = 8887</code> and <code>sd = 500</code>. Putting it all
together the function call looks like this:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">10000</span>, mean <span class="op">=</span> <span class="fl">8887</span>, sd <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6.698213e-05</span></span></code></pre>
<p>So the probability of measuring 10,000 from this distribution is only
0.0067%. That is a vanishingly small number. I guess we should be
flabbergasted by this measurement. But let’s take a step back, that is
the probability of measuring <em>exactly</em> 10,000 grams of
CO<sub>2</sub>. The probability of measuring any number exactly is
usually pretty small, even the average:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">8887</span>, mean <span class="op">=</span> <span class="fl">8887</span>, sd <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.0007978846</span></span></code></pre>
<p>That’s only a 0.08% chance of measuring <em>exactly</em> the
mean.</p>
</div>
<div class="section level3">
<h3 id="probability-of-more-or-less-than-a-value-pnorm">Probability of more-or-less than a value: <code>pnorm()</code><a class="anchor" aria-label="anchor" href="#probability-of-more-or-less-than-a-value-pnorm"></a>
</h3>
<p>Usually, we’re interested in the probability of getting an
observation which is smaller or greater than our value of interest. For
example, what’s the probability of measuring up to 10,000 grams of
CO<sub>2</sub>? For this, we use <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fl">10000</span>, mean <span class="op">=</span> <span class="fl">8887</span>, sd <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.9869929</span></span></code></pre>
<p>98.7% chance. Or, in other words, 98.7% of the data is
<em>smaller</em> than 10,000.</p>
<p>The default for the <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm()</a></code> function measures the
probability of getting <em>up to</em> our value of interest. In other
words, it is measuring the area under the curve to the left of our
value.</p>
<p><img src="lab_03_normal-distributions_files/figure-html/area-shade-left-plot-1.png" width="700"></p>
<p>What if we wanted to look at the area under the curve to the right of
our value? Or what the probability of measuring a value greater than our
value of interest?</p>
<p><img src="lab_03_normal-distributions_files/figure-html/area-shade-right-plot-1.png" width="700"></p>
<p>We can calculate this probability by modifying our code in 2
ways.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first way</span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fl">10000</span>, mean <span class="op">=</span> <span class="fl">8887</span>, sd <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.01300709</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># second way</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fl">10000</span>, mean <span class="op">=</span> <span class="fl">8887</span>, sd <span class="op">=</span> <span class="fl">500</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.01300709</span></span></code></pre>
<p>In the first example, we take advantage of the fact that the entire
area under the curve has to sum to 1. This is because the complete area
under the curve represents 100% of all probabilities. So since our
original code was calculating the area to the left, then the area to the
right has to be equal to one minus that area.</p>
<p>In the second way, we add an argument <code>lower.tail = FALSE</code>
to change the default of <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm()</a></code>, and have it measure the
area to the right.</p>
<p>We can combine this information to calculate the probability of
getting a measurement between 2 values, let’s say between 9,000 and
10,000.</p>
<p><img src="lab_03_normal-distributions_files/figure-html/area-shade-between-plot-1.png" width="700"></p>
<p>To calculate this, we need to make two calls using the
<code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm()</a></code> function. In the first, we calculate the
probability from the left to our maximum value of interest:
<code>pnorm(10000, mean = 8887, sd = 500)</code>. This gives us the area
of the light grey (to the left) and the blue shaded regions in the
figure above.</p>
<p>Then, we need to calculate the area of the lighter grey region using
<code>pnorm(9000, mean = 8887, sd = 500)</code> and subtract that from
the area calculated above. In R, we would type the following:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fl">10000</span>, mean <span class="op">=</span> <span class="fl">8887</span>, sd <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fl">9000</span>, mean <span class="op">=</span> <span class="fl">8887</span>, sd <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.3975936</span></span></code></pre>
<p>Which gives us approximately a 40% chance of observing a value
between 9000 and 10,000.</p>
</div>
<div class="section level3">
<h3 id="what-value-is-a-quantile-of-our-data-qnorm">What value is a quantile of our data? <code>qnorm()</code><a class="anchor" aria-label="anchor" href="#what-value-is-a-quantile-of-our-data-qnorm"></a>
</h3>
<p>We are often interested in knowing what value breaks off a specific
percentage of the data. For example, above we found out the ~98.7% of
our data was smaller than 10,000, but we might be interested in knowing
what value marks the 95th percentile, or the 1st, or the 30th, etc.
Luckily, this is exactly what the <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm()</a></code> function is for.
Once again, this function takes our value of interest as the first
argument, and then names arguments for the <code>mean</code> and
<code>sd</code> which describe our distribution.</p>
<p>Using our example above, we can ask what specific value marks the
95th percentile:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.95</span>, mean <span class="op">=</span> <span class="fl">8887</span>, sd <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 9709.427</span></span></code></pre>
<p>Likewise, we can supply multiple numbers in the first argument using
the <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> function. For example, if we want to know what
values mark the 10th, 20th, 80th and 90th percentiles, we can enter the
following:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">8887</span>, sd <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 8246.224 8466.189 9307.811 9527.776</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="the-standard-normal-distribution">The Standard Normal Distribution<a class="anchor" aria-label="anchor" href="#the-standard-normal-distribution"></a>
</h2>
<p>The standard normal distribution (often call the Z-distribution) is a
special case where <code>mean = 0</code>, and <code>sd = 1</code>. This
distribution has a few special features which are helpful when we are
thinking about data. Recall that approximately 68% of the data falls
within one standard deviation of the mean, and 95% and 99.7% fall within
2 and 3 sd’s respectively. Because the standard normal distribution has
<code>sd = 1</code>, it makes it very easy to estimate where an
observation lands within the distribution.</p>
<table class="table">
<thead><tr>
<th style="text-align:center;">
Percentage
</th>
<th style="text-align:center;">
Min Value
</th>
<th style="text-align:center;">
Max Value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
68%
</td>
<td style="text-align:center;">
-1
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
95%
</td>
<td style="text-align:center;">
-2
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
99.7%
</td>
<td style="text-align:center;">
-3
</td>
<td style="text-align:center;">
3
</td>
</tr>
</tbody>
</table>
<p>For example, if I tell you that I observed a value of 0.25 from a
standard normal distribution, you can quickly surmise that it is within
68% of the data (0.25 falls within the range of <code>(-1, 1)</code>).
In other words, this is an expected value which is close to the
mean.</p>
<p>What if I told you I measured a value of -3.7 from a standard normal
distribution? What would your initial thought be? If you refer back to
the table, you should see that 99.7% of the data falls between
<code>(-3, 3)</code>, so a value of -3.7 (i.e., less than -3) is in the
extreme left tail of the distribution.</p>
<p>So far, we have been playing around with a (made up) distribution of
CO<sub>2</sub> emissions from burning a gallon of gas, which can be
described with <code>mean = 8887</code> and <code>sd = 500</code>. You
can use the same rules above to determine if a value is within so many
SD’s of the mean by using ranges of the mean minus x * the standard
deviation:</p>
<table class="table">
<thead><tr>
<th style="text-align:center;">
Percentage
</th>
<th style="text-align:center;">
Min Value
</th>
<th style="text-align:center;">
Max Value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
68%
</td>
<td style="text-align:center;">
8387
</td>
<td style="text-align:center;">
9387
</td>
</tr>
<tr>
<td style="text-align:center;">
95%
</td>
<td style="text-align:center;">
7887
</td>
<td style="text-align:center;">
9887
</td>
</tr>
<tr>
<td style="text-align:center;">
99.7%
</td>
<td style="text-align:center;">
7387
</td>
<td style="text-align:center;">
10387
</td>
</tr>
</tbody>
</table>
<p>So if I told you I had a measurement of 7,500, you could use the
above table to quickly estimate that it is somewhere within 95 to 99.7%
of the data, or in the left tail of the distribution.</p>
<p>However this is less intuitive then using the standard normal
distribution. Likewise, it requires a bit of mental math, can be time
confusing and is prone to error. Luckily, there is a method for
standardizing any normal distirbution into the standard normal
distribution using Z-scores.</p>
<div class="section level3">
<h3 id="z-scores">Z-scores<a class="anchor" aria-label="anchor" href="#z-scores"></a>
</h3>
<p>An amazing feature of normal distributions is that you can transform
any one of them into a standard normal distribution. This is
accomplished using the following equation:</p>
<p><span class="math display">\[\Large z = \frac{x_{i} - \mu}
{\sigma}\]</span></p>
<p>where <span class="math inline">\(z\)</span> is the standardized
score, <span class="math inline">\(x_{i}\)</span> is the observation
from your data and <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are the mean and sd of the data,
respectively.</p>
<p>Let’s calculate the standardized z-score of our CO<sub>2</sub>
observation.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># observation = 10000</span></span>
<span><span class="co"># mean = 8887</span></span>
<span><span class="co"># sd = 500</span></span>
<span><span class="op">(</span><span class="fl">10000</span> <span class="op">-</span> <span class="fl">8887</span><span class="op">)</span> <span class="op">/</span> <span class="fl">500</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.226</span></span></code></pre>
<p>This value is greater than 2, so falls somewhere between the 95 and
99.7% of the data distribution.</p>
</div>
<div class="section level3">
<h3 id="comparing-observations-using-z-scores">Comparing observations using z-scores<a class="anchor" aria-label="anchor" href="#comparing-observations-using-z-scores"></a>
</h3>
<p>The benefit of using z-scores becomes apparent when we want to
compare observations from two different distributions. For example,
let’s compare student scores from two different common standardized
tests: the ACT and the SAT.</p>
<p>The distribution of test scores on the SAT and the ACT are both
nearly normal, but are on different scales. The SAT ranges from
400-1600, while the ACT ranges from 1-36.</p>
<p>Suppose that one student scores an 1800 on the SAT (Student A) and
another student scores a 24 on the ACT (Student B). Which student
performed better?</p>
<ul>
<li><p>SAT scores are <span class="math inline">\({Normal}( \mu = 1500,
\sigma = 300)\)</span><br></p></li>
<li><p>ACT scores are <span class="math inline">\({Normal}(\mu = 21,
\sigma = 5)\)</span></p></li>
<li><p><span class="math inline">\(x_A\)</span> represents the score of
Student A; <span class="math inline">\(x_B\)</span> represents the score
of Student B.</p></li>
</ul>
<p><span class="math display">\[Z_{A} = \frac{x_{A} -
\mu_{SAT}}{\sigma_{SAT}} = \frac{1800-1500}{300} = 1 \]</span></p>
<p><span class="math display">\[Z_{B} = \frac{x_{B} -
\mu_{ACT}}{\sigma_{ACT}} = \frac{24 - 21}{5} = 0.6\]</span></p>
<p>Student A has a z-score of 1, which is higher than the z-score for
student B of 0.6. So student A was further away from the mean then
student B and because the value was positive it’s closer to the right
side of the distribution. In other words, student A performed better
than student B.</p>
<div class="float">
<img src="sat-act.png" style="width:50.0%" alt="Figure 11. SAT and ACT SCores. (image credit Open Intro Statistics)"><div class="figcaption">Figure 11. SAT and ACT SCores. (image credit
Open Intro Statistics)</div>
</div>
</div>
<div class="section level3">
<h3 id="log-normal-distribution">Log-Normal Distribution<a class="anchor" aria-label="anchor" href="#log-normal-distribution"></a>
</h3>
<p>Let’s look at an example of a non-normal distribution.</p>
<p>Run the following code to make this plot:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">987</span><span class="op">)</span> <span class="co"># for reproducibility</span></span>
<span><span class="va">x_ln</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span> <span class="co"># sample 1000 observations from a log-normal distribution </span></span>
<span></span>
<span><span class="co"># plot the values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">x_ln</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_03_normal-distributions_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>We can see that this is a highly skewed data set; lots of
observations on the left side (peak) with a very few observations of
really large numbers.</p>
</div>
<div class="section level3">
<h3 id="transformations">Transformations<a class="anchor" aria-label="anchor" href="#transformations"></a>
</h3>
<p>There are a number of transformations that we can perform on the data
to make the observations normally distributed. For example, the
log-normal distribution is one that becomes normal after we log
transform it. Run the following:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_tranformed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x_ln</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">x_tranformed</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_03_normal-distributions_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>We can see now that the distribution is approximately normal. We will
discuss other transformations as they come up in class later.</p>
<p><a href="https://www.datanovia.com/en/lessons/transform-data-to-normal-distribution-in-r/" class="external-link">Other
examples of non-normal data and transformations</a> positive and
negativer skew</p>
</div>
</div>
<div class="section level2">
<h2 id="coda">Coda<a class="anchor" aria-label="anchor" href="#coda"></a>
</h2>
<p>You should now be able to complete HW 02 Normal Distributions</p>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 id="exampe-code-for-figures">Exampe code for figures<a class="anchor" aria-label="anchor" href="#exampe-code-for-figures"></a>
</h3>
<div class="section level4">
<h4 id="figure-1">Figure 1<a class="anchor" aria-label="anchor" href="#figure-1"></a>
</h4>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set random number generator seed</span></span>
<span><span class="co"># makes results reproducible</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3987</span><span class="op">)</span></span>
<span><span class="co"># simulate 4 data sets with same mean, different SD</span></span>
<span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10000</span>, sd <span class="op">=</span> <span class="fl">2</span>,mean <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10000</span>, sd <span class="op">=</span> <span class="fl">2</span>,mean <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">y3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10000</span>, sd <span class="op">=</span> <span class="fl">2</span>,mean <span class="op">=</span> <span class="op">-</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">y4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10000</span>, sd <span class="op">=</span> <span class="fl">2</span>,mean <span class="op">=</span> <span class="op">-</span><span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combine data into one data.frame (i.e., a table)</span></span>
<span><span class="va">ydf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y1</span>, <span class="va">y2</span>, <span class="va">y3</span>, <span class="va">y4</span><span class="op">)</span>,</span>
<span>           mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"10"</span>, <span class="st">"-5"</span>, <span class="st">"-20"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># make plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ydf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span>,</span>
<span>                group <span class="op">=</span> <span class="va">mean</span>,</span>
<span>                fill <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, adjust <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Figure 1. Normal distributions with the same SD but different means"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="figure-2">Figure 2<a class="anchor" aria-label="anchor" href="#figure-2"></a>
</h4>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make reproducible, and sample data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3987</span><span class="op">)</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">8887</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10000</span>, mean <span class="op">=</span> <span class="fl">8887</span>, sd <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combine data into data.frame</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span>,</span>
<span>                 grp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"big SD"</span>, <span class="st">"small SD"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,</span>
<span>               group <span class="op">=</span> <span class="va">grp</span>,</span>
<span>               fill <span class="op">=</span> <span class="va">grp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"co2"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Figure 2. Normal distributions with the same mean but different SDs"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level4">
<h4 id="figure-7">Figure 7<a class="anchor" aria-label="anchor" href="#figure-7"></a>
</h4>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"co2"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Figure 7."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add arrow as an "annotation"</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, </span>
<span>           x <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>           xend <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>           y <span class="op">=</span> <span class="fl">2e-04</span>,</span>
<span>           yend <span class="op">=</span> <span class="fl">0</span>,</span>
<span>           color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>           arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="st">"npc"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="figure-8">Figure 8<a class="anchor" aria-label="anchor" href="#figure-8"></a>
</h4>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this is more complicated</span></span>
<span><span class="co"># don't worry if you don'totally follow it</span></span>
<span></span>
<span><span class="co"># define intervals to shade</span></span>
<span><span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">10000</span>, <span class="cn">Inf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make base plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dodgerblue"</span>, <span class="st">"grey"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add shading</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">stat_density</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fl">500</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">breaks</span><span class="op">)</span>,</span>
<span>      group <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_scale</a></span><span class="op">(</span><span class="va">fill</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Figure 8. Area shaded to the left of our value (in blue)"</span><span class="op">)</span></span></code></pre></div>
<script>
$(document).ready(function() {
  $('.footnotes ol').appendTo('#endnotes');
  $('.footnotes').remove();
});
</script>
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>The mean estimate of 8,887 grams was taken from the US
<a href="https://www.epa.gov/greenvehicles/greenhouse-gas-emissions-typical-passenger-vehicle#:~:text=Every%20gallon%20of%20gasoline%20burned%20creates%20about%208%2C887%20grams%20of%20CO2." class="external-link">EPA
website</a> and the standard deviation of 500 grams was made up because
I couldn’t find a good estimate online.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Justin Pomeranz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

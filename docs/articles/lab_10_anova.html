<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 10: ANOVA • ENVS475</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 10: ANOVA">
<meta property="og:description" content="ENVS475">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ENVS475</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2025.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fa fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fa fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-desktop"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/lecture_01/lecture_01.html">Lecture 01: Course introduction</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_03_basic-stats/lecture_03_basic-stats_2025.html">Lecture 03: Basic Statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_05_estimation/lecture_05_estimation.html">Lecture 05: Point Estimates</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_06_intro-models/lecture_06_intro-models.html">Lecture 06: Intro to Models</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_07_t-tests/lecture_07_t-tests.html">Lecture 07: t-tests</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_09_tidy/lecture_09_tidy.html">Lecture 09: Tidy</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_10_anova/lecture_10_anova.html">Lecture 10: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_11_factorial/lecture_11_factorial_anova.pdf">Lecture 11: Factorial</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_12_two-way/lecture_12_two-way.pdf">Lecture 12: Factorial</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_13_regression/lecture_13_regression.pdf">Lecture 13: Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop-code"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab_01_projects.html">lab 01: projects</a>
    </li>
    <li>
      <a href="../articles/lab_02_intro_to_R.html">lab 02: Intro to R</a>
    </li>
    <li>
      <a href="../articles/lab_03_normal-distributions.html">lab 03: Normal Distributions</a>
    </li>
    <li>
      <a href="../articles/lab_04a_dplyr.html">lab 04a: dplyr</a>
    </li>
    <li>
      <a href="../articles/lab_04b_ggplot.html">lab 04b: ggplot</a>
    </li>
    <li>
      <a href="../articles/lab_05_point-estimates.html">lab 05: point estimates</a>
    </li>
    <li>
      <a href="../articles/lab_06_linear-models.html">lab 06: linear models</a>
    </li>
    <li>
      <a href="../articles/lab_08_t-tests.html">lab 07: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab_09_tidy-data-entry.html">lab 09: Tidy Data Entry</a>
    </li>
    <li>
      <a href="../articles/lab_10_anova.html">lab 10: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab_11_factorial-anova.html">lab 11: Factorial ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab_12_2-way-anova.html">lab 12: 2-way anova</a>
    </li>
    <li>
      <a href="../articles/lab_13_linear-regression.html">lab 13: Linear Regression</a>
    </li>
    <li>
      <a href="../articles/lab_14_ANCOVA.html">lab 14: ANCOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-folder-open"></span>
     
    Homework
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework/HW_01.html">Homework 01 setup</a>
    </li>
    <li>
      <a href="../articles/homework/HW_02_intro_R.html">Homework 02 Intro to R</a>
    </li>
    <li>
      <a href="../articles/homework/HW_03_normal-distributions.html">Homework 03 Normal Distributions</a>
    </li>
    <li>
      <a href="../articles/homework/HW_04_dplyr_ggplot.html">Homework 04 dplyr + ggplot2</a>
    </li>
    <li>
      <a href="../articles/homework/HW_05_point-estimates.html">Homework 05 Point Estimates</a>
    </li>
    <li>
      <a href="../articles/homework/HW_06_linear_models.html">Homework 06 Intro to Linear Models</a>
    </li>
    <li>
      <a href="../articles/homework/HW_07_t-tests.html">Homework 07 t-tests</a>
    </li>
    <li>
      <a href="../articles/homework/HW_09_tidy.html">Homework 09 Tidy</a>
    </li>
    <li>
      <a href="../articles/homework/HW_10_ANOVA.html">Homework 10 ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_11_factorial.html">Homework 11 Factorial ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_12_two-way-ANOVA.html">Homework 12 2-way ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_13_linear-regression.html">Homework 13 Linear Regression</a>
    </li>
    <li>
      <a href="../articles/homework/HW_14_ANCOVA.html">Homework 14 ANCOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/term-list.html">Terms and Definitions</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 10: ANOVA</h1>
            <h3 data-toc-skip class="subtitle">ENVS475: Experimental
Analysis and Design</h3>
            
            <h4 data-toc-skip class="date">Spring, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Jpomz/ENVS475/blob/HEAD/vignettes/articles/lab_10_anova.Rmd" class="external-link"><code>vignettes/articles/lab_10_anova.Rmd</code></a></small>
      <div class="hidden name"><code>lab_10_anova.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="about">About<a class="anchor" aria-label="anchor" href="#about"></a>
</h2>
<p>This lab will demonstrate how to perform a one-way ANOVA in R. This
includes checking assumptions, fitting the linear model, and
interpreting the results/</p>
</div>
<div class="section level2">
<h2 id="preliminaries">Preliminaries<a class="anchor" aria-label="anchor" href="#preliminaries"></a>
</h2>
<div class="section level4">
<h4 id="packages">Packages<a class="anchor" aria-label="anchor" href="#packages"></a>
</h4>
<p>For this lab, we will be using the <code>dplyr</code> and
<code>ggplot2</code> packages. Make sure both packages are installed on
your computer, and then run the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h4>
<p>We will use the <code>PlantGrowth</code> data which comes with base
R. Load the data by running the following command:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"PlantGrowth"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h2>
<p>First we will take a look at the <code>PlantGrowth</code> data</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">PlantGrowth</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "weight" "group"</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">PlantGrowth</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 30  2</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">PlantGrowth</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   weight group</span></span>
<span><span class="co">## 1   4.17  ctrl</span></span>
<span><span class="co">## 2   5.58  ctrl</span></span>
<span><span class="co">## 3   5.18  ctrl</span></span>
<span><span class="co">## 4   6.11  ctrl</span></span>
<span><span class="co">## 5   4.50  ctrl</span></span>
<span><span class="co">## 6   4.61  ctrl</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">PlantGrowth</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      weight       group   </span></span>
<span><span class="co">##  Min.   :3.590   ctrl:10  </span></span>
<span><span class="co">##  1st Qu.:4.550   trt1:10  </span></span>
<span><span class="co">##  Median :5.155   trt2:10  </span></span>
<span><span class="co">##  Mean   :5.073            </span></span>
<span><span class="co">##  3rd Qu.:5.530            </span></span>
<span><span class="co">##  Max.   :6.310</span></span></code></pre>
<p>We can see that this data has 30 observations (rows) across two
variables (columns). The <code>weight</code> variable records the dry
weight of plants and the <code>group</code> variable indicates which of
three experimental treatments the individual plants were assigned. The
three treatments are:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">PlantGrowth</span>, <span class="va">group</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   group</span></span>
<span><span class="co">## 1  ctrl</span></span>
<span><span class="co">## 2  trt1</span></span>
<span><span class="co">## 3  trt2</span></span></code></pre>
<div class="section level3">
<h3 id="plot-data">Plot data<a class="anchor" aria-label="anchor" href="#plot-data"></a>
</h3>
<p>Let’s start by plotting all of the data, without considering the
groups.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">PlantGrowth</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>,</span>
<span>           y <span class="op">=</span> <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="lab_10_anova_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Now, we will add the grouping variable to see how the variability is
distributed across treatment types.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">PlantGrowth</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>,</span>
<span>           y <span class="op">=</span> <span class="va">weight</span>,</span>
<span>           color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="lab_10_anova_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="check-pre-analysis-assumptions">Check pre-analysis assumptions<a class="anchor" aria-label="anchor" href="#check-pre-analysis-assumptions"></a>
</h3>
<div class="section level4">
<h4 id="assumption-equal-variance">Assumption: equal variance<a class="anchor" aria-label="anchor" href="#assumption-equal-variance"></a>
</h4>
<p>These data look to have approximately equal variation across the
treatment groups. There are a couple of “high” data points in
<code>trt1</code>, but ANOVA is fairly robust to these assumptions, and
this looks ok for further analysis.</p>
<p>We can also formally test for equal variances using Levene’s test or
Bartlett’s test. For now, we will just assess this visually looking at
the boxplots of each group. We will return to formal tests of equal
variance later in the semester.</p>
</div>
<div class="section level4">
<h4 id="assumptions-normality-of-residuals">Assumptions: Normality of residuals<a class="anchor" aria-label="anchor" href="#assumptions-normality-of-residuals"></a>
</h4>
<p>We can also check to see if the residuals are normally ditributed by
creating a QQ-plot.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">PlantGrowth</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">stat_qq</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">stat_qq_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_10_anova_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>All of the observations (points) fall nearly directly on the
reference line, so once again we pass this assumption and can continue
with an Analysis of Variance (ANOVA).</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="anova">ANOVA<a class="anchor" aria-label="anchor" href="#anova"></a>
</h2>
<div class="section level3">
<h3 id="hypotheses-with-anova">Hypotheses with ANOVA<a class="anchor" aria-label="anchor" href="#hypotheses-with-anova"></a>
</h3>
<p>In an ANOVA analysis, we are testing whether or not there is a
difference in at least two of the group means in our data. It is easy to
write out the Null hypothesis as:</p>
<p><span class="math display">\[H0: \mu_1 = \mu_2 = \mu_3  ... =
\mu_i\]</span> Or, by saying that “all means are equal”.</p>
<p>Our alternative hypothesis is that “at least one mean is different”.
Becasue this inequality could happen between any pairwise combinations,
it is no simple task to write these out mathematically, so instead we
generally say:</p>
<p><span class="math display">\[HA: \text{"At least one mean is
different"}\]</span></p>
</div>
<div class="section level3">
<h3 id="anova-with-lm">ANOVA with <code>lm()</code><a class="anchor" aria-label="anchor" href="#anova-with-lm"></a>
</h3>
<div class="section level4">
<h4 id="assumption-equal-variance-of-residuals">Assumption: Equal variance of residuals<a class="anchor" aria-label="anchor" href="#assumption-equal-variance-of-residuals"></a>
</h4>
<p>Let’s first fit a linear model to the data, and check our post-model
fit assumption with a fitted vs. residuals plot.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plant_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plant_lm</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.fitted</span>, y <span class="op">=</span> <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>      position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span></span>
<span>        width <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>        height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_10_anova_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>In this plot, the absolute magnitude of the maximum and minimum
y-values are approximately the same (-1, 1), and there is no clear
pattern</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="anova-table">ANOVA table<a class="anchor" aria-label="anchor" href="#anova-table"></a>
</h2>
<p>In order to get the statistical values for the ANOVA table, we need
to use the <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> function on the model fit object.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">plant_lm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Analysis of Variance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: weight</span></span>
<span><span class="co">##           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  </span></span>
<span><span class="co">## group      2  3.7663  1.8832  4.8461 0.01591 *</span></span>
<span><span class="co">## Residuals 27 10.4921  0.3886                  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p>This table gives us the two degrees of freedom for the model (2, and
27), as well as the sum of squares, the mean of squares, and for the
group factor we also get the F-value and the p-value.</p>
<p>The degrees of freedom for the group factor is equal to the number of
groups - 1. Here we have 3 groups - 1 = 2 degrees of freedom.</p>
<p>The degrees of freedom for the residuals is the total number of
observations (30) minus 1 for each group (30 - 3 = 27).</p>
<p>The F-value is similar to the t-value from the t-test analyses we
ran, and is a measure of the ratio of the signal (differences in group
means) to the noise (variation in groups). If there was no treatment
effect (i.e., no “signal”) the ratio would be ~1. Larger F-value
indicate more signal to noise, and are interpreted as there being a
treatment effect.</p>
<p>The p-value is an indication of the likelihood of observing the data
(i.e., F-value, signal / noise ratio) we have <em>if</em> the null
hypothesis was true. In this case, a p-value of 0.016 is less than <span class="math inline">\(\alpha = 0.05\)</span>, and we can conclude that
there is a significant difference between at least two of the means.</p>
<div class="section level3">
<h3 id="anova-interpretation">ANOVA Interpretation<a class="anchor" aria-label="anchor" href="#anova-interpretation"></a>
</h3>
<p>Remember that the hypotheses for ANOVA are either that all means are
the same, or that at least one was different. ANOVA can only tell us
that there is a difference. Therefore, out interpretation would look
something like this:</p>
<blockquote>
<p>Based on the data, we can conlude that at least one of the means in
the fertilizer groups are significantly different (one-way ANOVA: <span class="math inline">\(F_{2, 27}= 4.85\)</span>, <span class="math inline">\(p = 0.016\)</span>)</p>
</blockquote>
<p>In order to see <em>which</em> means are different, we can view the
summary output from the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> model.</p>
</div>
</div>
<div class="section level2">
<h2 id="linear-model-summary">Linear Model Summary<a class="anchor" aria-label="anchor" href="#linear-model-summary"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">plant_lm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = weight ~ group, data = PlantGrowth)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -1.0710 -0.4180 -0.0060  0.2627  1.3690 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)   5.0320     0.1971  25.527   &lt;2e-16 ***</span></span>
<span><span class="co">## grouptrt1    -0.3710     0.2788  -1.331   0.1944    </span></span>
<span><span class="co">## grouptrt2     0.4940     0.2788   1.772   0.0877 .  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.6234 on 27 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.2641, Adjusted R-squared:  0.2096 </span></span>
<span><span class="co">## F-statistic: 4.846 on 2 and 27 DF,  p-value: 0.01591</span></span></code></pre>
<p>Here, we can see that we have three coefficients:
<code>(Intercept)</code>, <code>grouptrt1</code>, and
<code>grouptrt2</code>.</p>
<p>Each of these coefficient estimates has an associated Null and
Alternative hypothesis.</p>
<div class="section level3">
<h3 id="coefficient-hypotheses">Coefficient hypotheses<a class="anchor" aria-label="anchor" href="#coefficient-hypotheses"></a>
</h3>
<div class="section level4">
<h4 id="intercept-beta_0">Intercept, <span class="math inline">\(\beta_0\)</span><a class="anchor" aria-label="anchor" href="#intercept-beta_0"></a>
</h4>
<p><span class="math display">\[ H0: \beta_0 = 0 \]</span> <span class="math display">\[ HA: \beta_0 \ne 0 \]</span> As mentioned
previously, we are rarely interested in this hypothesis.</p>
<p>The <code>(Intercept)</code> coefficient is the mean weight estimate
for the <code>ctrl</code> group, and is equal to 5.032. The p-value
associated with this simply means that the data support the conclusion
that the mean weight of the control plants are not 0.</p>
</div>
<div class="section level4">
<h4 id="other-coefficients-beta_trt1-and-beta_trt2">Other coefficients, <span class="math inline">\(\beta_{trt1}\)</span>, and <span class="math inline">\(\beta_{trt2}\)</span><a class="anchor" aria-label="anchor" href="#other-coefficients-beta_trt1-and-beta_trt2"></a>
</h4>
<p>The other two coefficients represent the estimated difference between
the <code>ctrl</code> group and the respective <code>trt</code>
groups.</p>
<p>The null hypothesis for each of these coefficients is:</p>
<p><span class="math display">\[H0: \beta_i = 0\]</span></p>
<p>and the Alternative is:</p>
<p><span class="math display">\[HA: \beta_i \ne 0\]</span></p>
<p>The p-values for both of the other coefficients is <span class="math inline">\(&gt; \alpha = 0.05\)</span>, so we fail to reject
these hypotheses. In other words, the data do not support a significant
difference in plant weights for either treatment when compared with the
control group.</p>
</div>
</div>
<div class="section level3">
<h3 id="mean-estimates-for-treatment-groups">Mean estimates for treatment groups<a class="anchor" aria-label="anchor" href="#mean-estimates-for-treatment-groups"></a>
</h3>
<p>We can combine the coefficient estimates to calculate the mean plant
weight for the two treatment groups:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print out all the coefficient estimates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">plant_lm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## (Intercept)   grouptrt1   grouptrt2 </span></span>
<span><span class="co">##       5.032      -0.371       0.494</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># mean estimate for trt1, manual</span></span>
<span><span class="fl">5.032</span> <span class="op">-</span> <span class="fl">0.371</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4.661</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># or by using the coefficient estimates:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">plant_lm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">plant_lm</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4.661</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># mean estimate for trt2, manual</span></span>
<span><span class="fl">5.032</span> <span class="op">+</span> <span class="fl">0.494</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5.526</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># or by using the coefficient estimates:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">plant_lm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">plant_lm</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5.526</span></span></code></pre>
<p>We can also look at the confidence intervals for the three
coefficients using the <code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> function:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">plant_lm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                   2.5 %    97.5 %</span></span>
<span><span class="co">## (Intercept)  4.62752600 5.4364740</span></span>
<span><span class="co">## grouptrt1   -0.94301261 0.2010126</span></span>
<span><span class="co">## grouptrt2   -0.07801261 1.0660126</span></span></code></pre>
<p>Notice that both confidence intervals for the difference cross zero
(lower bound is negative, upper bound is positive). This is a good
indication that there is not a significant difference between the
control group and either treatment.</p>
</div>
<div class="section level3">
<h3 id="lm-interpretation---following-hector-2021">
<code>lm()</code> Interpretation - Following Hector (2021)<a class="anchor" aria-label="anchor" href="#lm-interpretation---following-hector-2021"></a>
</h3>
<p>The plants from the control group had an average dry weight of 5.032
(95% CI: 4.63, 5.44) grams, and the difference in dry weights for
treatment 1 was -0.37 (-0.94, 0.20) while the difference in dry weights
for treatment 2 was 0.49 (-0.08, 1.07)</p>
<p>You may have noticed that results from the ANOVA table above
indicated that there was at least one significant difference between
means, but the p-values of 95%CIs from the linear model indicate no
significant difference, so what happened?</p>
<p>Well, you might have realized that the linear model is only testing
whether the two treatment groups are different from the control group.
One combination that we are missing is whether or not the two treatments
are different from each other. We could go through the process of
re-levelling the data so that we set one of the treatment groups is our
reference condition. However, it’s most likely that the original
experiment was interested in differences from the control condition, and
this is how our analysis was originally set up. We could just run a few
extra t-tests to analyze all possible combinations. However, when
running multiple t-tests, we increase our chances of a Type I error
(i.e., false positive). To account for that, we will continue this
analysis by running a multiple comparison test.</p>
</div>
</div>
<div class="section level2">
<h2 id="multiple-comparisons">Multiple Comparisons<a class="anchor" aria-label="anchor" href="#multiple-comparisons"></a>
</h2>
<div class="section level4">
<h4 id="a-caveat">A caveat<a class="anchor" aria-label="anchor" href="#a-caveat"></a>
</h4>
<p>First, a brief note. For many years, it was considered standard to
run an ANOVA, and then if those results came back significant to run
some form of multiple comparison analysis to see which combinations were
significant (what we will do below). As a part of the “New Statistics”,
and general reforms currently happening in statistical analyses, this is
beginning to go out of fashion. There are a few different opinions on
this.</p>
<p>One, is to set up the linear model analysis to maximize your degrees
of freedom and answer the original research question. For example,
above, we had the control group as the default reference condition, and
if we were only interested in differences between control and treatment
groups, we would stop at the interpretation of the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>
summary above.</p>
<p>Secondly, some researchers concede that all statistical analyses have
a chance of false positives (indeed, the definition of a 95% CI
explicitly states that under repeated sampling conditions, the “true
mean” will only be in the interval ~95% of the time), and therefore it’s
fine to run extra t-tests and discuss potential false positive rates in
the discussion section. (The <code>PlantGrowth</code> example is in a
bit of a grey area. Since it’s only a total of 3-pairwise comparisons,
running an additional t-test is really not that big of a deal. Where it
really becomes important is when you’re running lots and lots of
comparisons. For example, the <code>OrchardSpray</code> problem in
homework 10.)</p>
<p>Finally, multiple comparisons are still being done and generally
still accepted. Furthermore, you will see these often in the literature,
and I think it’s important for you to know how to run and interpret
them. So for this lab, we will continue with Tukey’s Honestly
Significant Difference Test. However, be aware that there are other
corrections for multiple comparisons, and you will see things like
“Bonferroni corrections”, “F-protected t-tests”, “Fisher’s LEast
Significant Difference”, etc.</p>
</div>
<div class="section level3">
<h3 id="tukeys-hsd">Tukey’s HSD<a class="anchor" aria-label="anchor" href="#tukeys-hsd"></a>
</h3>
<p>As mentioned above, the results of the ANOVA test indicated
significant differences, but the linear model analysis did not find
differences between the control and either treatment group. However, one
final comparison is missing: the <code>trt1</code> and the
<code>trt2</code> group.</p>
<p>For this, we will run Tukey’s HSD test. This test is essentially the
same as the t-test we ran before, except that the critical value of t is
larger than for a normal t-test. Basically, we need <em>stronger
evidence</em> in order to reject the Null hypothesis.</p>
<p>Before we run the Tukey HSD test, we need to run an ANOVA on our
linear model fit using the <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> function.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ANOVA of our lm model</span></span>
<span><span class="va">plant_aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">plant_lm</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tukey's test on the plant_aov object</span></span>
<span><span class="va">plant_tukey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">plant_aov</span><span class="op">)</span></span>
<span><span class="co"># print out results</span></span>
<span><span class="va">plant_tukey</span></span></code></pre></div>
<pre><code><span><span class="co">##   Tukey multiple comparisons of means</span></span>
<span><span class="co">##     95% family-wise confidence level</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fit: aov(formula = plant_lm)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $group</span></span>
<span><span class="co">##             diff        lwr       upr     p adj</span></span>
<span><span class="co">## trt1-ctrl -0.371 -1.0622161 0.3202161 0.3908711</span></span>
<span><span class="co">## trt2-ctrl  0.494 -0.1972161 1.1852161 0.1979960</span></span>
<span><span class="co">## trt2-trt1  0.865  0.1737839 1.5562161 0.0120064</span></span></code></pre>
<p>Here, we can see that we have a row for every pairwise combination.
The table gives us an estimated and 95% CI for the differences, as well
as an adjusted p value. The p-value is already adjusted for the number
of comparisons, so we can compare it to our value of 0.05.</p>
<p>We can see here that neither of the treatment means is different from
the control group (p-value &gt; 0.05), but that trt1 and trt2 are
different with a p-value of 0.012.</p>
<p>We can also plot these differences. Any coefficient estimates which
cross zero are not considered to be significantly different.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">plant_tukey</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_10_anova_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="multiple-comparisons-interpretation">Multiple Comparisons Interpretation<a class="anchor" aria-label="anchor" href="#multiple-comparisons-interpretation"></a>
</h3>
<p>The data supports the conclusion that there was no statistically
significant difference in plant dry weight between the control and
either treatment group (Tukey HSD adjusted p-values &gt; 0.05). However,
the difference in plant dry weights between trt1 and trt was estimated
to be 0.865 (95%CI: 0.174, 1.56), and this was significant (Tukey HSD
adjusted p = 0.012)</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Justin Pomeranz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

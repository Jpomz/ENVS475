<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 08: t-tests • ENVS475</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 08: t-tests">
<meta property="og:description" content="ENVS475">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ENVS475</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2024.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fa fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fa fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-desktop"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/lecture_01/lecture_01.html">Lecture 01: Course introduction</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_02_normal/lecture_02_normal.html">Lecture 02: Normal Distributions</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_03_basic-stats/lecture_03_basic-stats.html">Lecture 03: Basic Statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_05_estimation/lecture_05_estimation.html">Lecture 05: Point Estimates</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_06_intro-models/lecture_06_intro-models.html">Lecture 06: Intro to Models</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_07_t-tests/lecture_07_t-tests.html">Lecture 07: t-tests</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_10_anova/lecture_10_anova.html">Lecture 10: ANOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop-code"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab_01_projects.html">lab 01: projects</a>
    </li>
    <li>
      <a href="../articles/lab_02_intro_to_R.html">lab 02: Intro to R</a>
    </li>
    <li>
      <a href="../articles/lab_03_normal-distributions.html">lab 03: Normal Distributions</a>
    </li>
    <li>
      <a href="../articles/lab_04a_dplyr.html">lab 04a: dplyr</a>
    </li>
    <li>
      <a href="../articles/lab_04b_ggplot.html">lab 04b: ggplot</a>
    </li>
    <li>
      <a href="../articles/lab_05_point-estimates.html">lab 05: point estimates</a>
    </li>
    <li>
      <a href="../articles/lab_06_linear-models.html">lab 06: linear models</a>
    </li>
    <li>
      <a href="../articles/lab_08_t-tests.html">lab 07: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab_07_intro_markdown.html">lab 09: intro to R markdown</a>
    </li>
    <li>
      <a href="../articles/lab_10_anova.html">lab 10: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab_11_factorial-anova.html">lab 11: Factorial ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab_12_2-way-anova.html">lab 12: 2-way anova</a>
    </li>
    <li>
      <a href="../articles/lab_13_linear-regression.html">lab 13: Linear Regression</a>
    </li>
    <li>
      <a href="../articles/lab_14_ANCOVA.html">lab 14: ANCOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-folder-open"></span>
     
    Homework
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework/HW_01.html">Homework 01 setup</a>
    </li>
    <li>
      <a href="../articles/homework/HW_02_intro_R.html">Homework 02 Intro to R</a>
    </li>
    <li>
      <a href="../articles/homework/HW_03_normal-distributions.html">Homework 03 Normal Distributions</a>
    </li>
    <li>
      <a href="../articles/homework/HW_04_dplyr_ggplot.html">Homework 04 dplyr + ggplot2</a>
    </li>
    <li>
      <a href="../articles/homework/HW_05_point-estimates.html">Homework 05 Point Estimates</a>
    </li>
    <li>
      <a href="../articles/homework/HW_06_linear_models.html">Homework 06 Intro to Linear Models</a>
    </li>
    <li>
      <a href="../articles/homework/HW_07_t-tests.html">Homework 07 t-tests</a>
    </li>
    <li>
      <a href="../articles/homework/HW_09_markdown.html">Homework 09 R Markdown</a>
    </li>
    <li>
      <a href="../articles/homework/HW_10_ANOVA.html">Homework 10 ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_11_factorial.html">Homework 11 Factorial ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_12_two-way-ANOVA.html">Homework 12 2-way ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_13_linear-regression.html">Homework 13 Linear Regression</a>
    </li>
    <li>
      <a href="../articles/homework/HW_14_ANCOVA.html">Homework 14 ANCOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/term-list.html">Terms and Definitions</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 08: t-tests</h1>
            <h3 data-toc-skip class="subtitle">ENVS475: Experimental
Analysis and Design</h3>
            
            <h4 data-toc-skip class="date">Spring, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Jpomz/ENVS475/blob/HEAD/vignettes/articles/lab_08_t-tests.Rmd" class="external-link"><code>vignettes/articles/lab_08_t-tests.Rmd</code></a></small>
      <div class="hidden name"><code>lab_08_t-tests.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="about">About<a class="anchor" aria-label="anchor" href="#about"></a>
</h3>
<p>This lab will explore formal hypothesis testing by considering
classic t-tests from a linear modelling perspective.</p>
</div>
<div class="section level3">
<h3 id="preliminaries">Preliminaries<a class="anchor" aria-label="anchor" href="#preliminaries"></a>
</h3>
<p>Recall that the general structure of a t-test is as follows:</p>
<p><span class="math display">\[\large t =
\frac{difference}{SE}\]</span></p>
<div class="section level4">
<h4 id="packages">Packages<a class="anchor" aria-label="anchor" href="#packages"></a>
</h4>
<p>For this lab, we will be using the <code>dplyr</code> and
<code>ggplot2</code> packages. Make sure both packages are installed on
your computer, and then run the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h4>
<p>For the first two parts of this lab, we will be creating data sets in
R. For the third part, you will need to download the
<code>caterpillar.csv</code> from D2L and place it in your
<code>data/</code> folder.</p>
</div>
</div>
<div class="section level2">
<h2 id="one-sample-t-test-stream-ph">One sample t-test: Stream pH<a class="anchor" aria-label="anchor" href="#one-sample-t-test-stream-ph"></a>
</h2>
<p>You may expect that streams around Grand Junction should have an
approximately neutral pH of 7. Let’s look at some simulated data and
formally tests whether or not the average stream pH is significantly
different from 7. Here, the value of interest is <span class="math inline">\(\mu_0 = 7\)</span></p>
<div class="section level3">
<h3 id="formal-hypotheses">Formal Hypotheses<a class="anchor" aria-label="anchor" href="#formal-hypotheses"></a>
</h3>
<p>We can state our hypotheses formally using Null and Alternatives as
follows:</p>
<p><span class="math display">\[H_0: \mu = 7\]</span> <span class="math display">\[H_A: \mu \ne 7\]</span></p>
<p>Since our Alternative hypothesis is <span class="math inline">\(\ne\)</span> this is a 2-tailed test. In other
words we have to account for the fact that pH could be higher or lower
than our null value of 7.</p>
<p>We can express this as a simple linear model:</p>
<p><span class="math display">\[y_i = \mu + \epsilon_i\]</span> where
<span class="math inline">\(y_i\)</span> is a single observation of
stream pH, <span class="math inline">\(\mu\)</span> is the population
mean, and <span class="math inline">\(\epsilon_i\)</span> is the
deviation from the expected value. Further, we expect the deviations to
be distributed normally:</p>
<p><span class="math display">\[\epsilon \sim N(0, \sigma)\]</span></p>
</div>
<div class="section level3">
<h3 id="analysis-manual">Analysis: Manual<a class="anchor" aria-label="anchor" href="#analysis-manual"></a>
</h3>
<p>Let’s look at some <strong>simulated data</strong>, and load it into
R as a vector.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulated data values</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6.2</span>, <span class="fl">6.8</span>, <span class="fl">7.3</span>, <span class="fl">6.4</span>, <span class="fl">6.3</span><span class="op">)</span></span></code></pre></div>
<p>First, let’s plot the data. For this example, we will use
<code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot()</a></code>. Becasue <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> requires the
data object to be a data.frame, we will quickly convert our vector
<code>y</code> inside of the function. We will also add a dashed line to
indicate where our value of interest (7) is.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">7</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="lab_08_t-tests_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>For the one-sample t-test, we will calculate all necessary variables
manually, and then compare it to using the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>
function.</p>
<p>Recall that we calculate a one-sample t-statistic with the
following:</p>
<p><span class="math display">\[t_{statistic} =\frac{\bar{y} - \mu_{0}
}{SEM_y}\]</span></p>
<p>Where <span class="math inline">\(\bar{y}\)</span> is the mean, <span class="math inline">\(\mu_0\)</span> is the value of interest (pH = 7)
and <span class="math inline">\(SEM\)</span> is calculated as <span class="math inline">\(s / \sqrt(n)\)</span>. Let’s calculate these
values in R and store them as objects.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">y_bar</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6.6</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_0</span> <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span><span class="va">mu_0</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 7</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">y_sd</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.4527693</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y_sem</span> <span class="op">&lt;-</span> <span class="va">y_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y_sem</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.2024846</span></span></code></pre>
<p>Now let’s calculate the t-statistic</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_stat</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">y_bar</span> <span class="op">-</span> <span class="va">mu_0</span><span class="op">)</span> <span class="op">/</span> <span class="va">y_sem</span></span>
<span><span class="va">t_stat</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -1.975459</span></span></code></pre>
<p>Now we need to calculate the t-critical value for this
t-distribution. We can use the <code><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt()</a></code> function. This is
similar to the <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm()</a></code> function we used previously for the
normal distribution, but now we are looking at the t-distribution. for
<code><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt()</a></code>, we need to supply the quantile (0.025) and the
degrees of freedom (df = n - 1 = 4). The standard <span class="math inline">\(\alpha\)</span> value is 0.05, but since this is a
2-tailed test we have to divide it by 2 (hence 0.025) in order to
account for both tails.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_crit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="fl">0.025</span>, df <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">t_crit</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -2.78</span></span></code></pre>
<p>Is our <code>t_stat</code> value <span class="math inline">\(\ge\)</span> our critical value? Note that we are
going to use the absolute values so that we do not need to worry about
using the proper &gt; or &lt; with negative numbers.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">t_stat</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">t_crit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<p>It is not, so we would fail to reject our null hypothesis. We can
also calculate a p-value for our <code>t_critical</code> value by using
the <code><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">pt()</a></code> function. We first calculate the probability of
observing out <code>t_stat</code>, and then multiply it by 2 since this
is a 2-tailed test. Also, we are going to use the absolute value of our
<code>t_stat</code> and set the <code>lower.tail = FALSE</code> argument
within <code><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">pt()</a></code>. This ensures that we don’t need to worry about
mixing up our + and - signs when calculating a p-value.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">one_samp_p_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">t_stat</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">4</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span></span>
<span><span class="va">one_samp_p_val</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.1194206</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h3>
<p>Based on our data, we estimate that the mean (<span class="math inline">\(\pm\)</span> SE) pH in streams near Grand Junction
is 6.6 (<span class="math inline">\(\pm\)</span> 0.2), and we fail to
reject the null hypothesis that stream pH is equal to 7 (<span class="math inline">\(t_{statistic} = -1.96, df = 4, p =
0.12\)</span>).</p>
</div>
<div class="section level3">
<h3 id="analysis-using-lm">Analysis: using <code>lm()</code><a class="anchor" aria-label="anchor" href="#analysis-using-lm"></a>
</h3>
<p>We can use the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function to automatically calculate
our values and test the hypothesis formally.</p>
<p>Recall that <code>y</code> is our observations of data, and our null
value is 7. When we run a one-sample t-test in <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>, we
have to subtract the value of interest from our data. Review the
numerator in the formula for the one-sample t-statistic above.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">one_sample_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">mu_0</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">one_sample_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = y - mu_0 ~ 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##    1    2    3    4    5 </span></span>
<span><span class="co">## -0.4  0.2  0.7 -0.2 -0.3 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">## (Intercept)  -0.4000     0.2025  -1.975    0.119</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.4528 on 4 degrees of freedom</span></span></code></pre>
<p>We can also reprint the values we calculated by hand and locate them
in the output table (note that we are subtracting mu_0 from y_bar to put
it on the same scale as our <code>(Intercept)</code> estimate in the
table):</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y_bar</span> <span class="op">-</span> <span class="va">mu_0</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.4</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y_sd</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.4527693</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y_sem</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.2024846</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_crit</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -2.776445</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">one_samp_p_val</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.1194206</span></span></code></pre>
<div class="section level4">
<h4 id="you-should-now-be-able-to-complete-problem-1-in-the-homework-assignment">
<strong>You should now be able to complete problem 1 in the homework
assignment</strong><a class="anchor" aria-label="anchor" href="#you-should-now-be-able-to-complete-problem-1-in-the-homework-assignment"></a>
</h4>
</div>
</div>
</div>
<div class="section level2">
<h2 id="two-sample-t-tests-tree-densities">Two-sample t-tests: Tree Densities<a class="anchor" aria-label="anchor" href="#two-sample-t-tests-tree-densities"></a>
</h2>
<p>Is the density of trees at high elevations different from low
elevations?</p>
<p><span class="math display">\[H_0: \mu_{high} = \mu_{low}\]</span>
<span class="math display">\[H_A: \mu_{high} \ne \mu_{low}\]</span> ##
Data</p>
<p>We will make a data.frame and call it <code>tree</code>. Normally,
you should type out everything in this class for practice, but copy and
paste the following code in order to avoid typing a mistake.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  elevation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Low"</span>, <span class="st">"High"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  dens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">14</span>, <span class="fl">18</span>, <span class="fl">17</span>, <span class="fl">29</span>, <span class="fl">31</span>, <span class="fl">14</span>, <span class="fl">16</span>, <span class="fl">22</span>, <span class="fl">15</span>, <span class="fl">2</span>, <span class="fl">11</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">19</span>, <span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Here, <code>dens</code> is the density of trees, and was simulated
for this exercise. Let’s once again plot our data to visualize how they
are distributed.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tree</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">elevation</span>, </span>
<span>           y <span class="op">=</span> <span class="va">dens</span>,</span>
<span>           fill <span class="op">=</span> <span class="va">elevation</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_08_t-tests_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="section level3">
<h3 id="analysis-manual-1">Analysis: Manual<a class="anchor" aria-label="anchor" href="#analysis-manual-1"></a>
</h3>
<p>Calculate statistics with dplyr. Recall that for a two-sample t-test
we need the:</p>
<p><span class="math display">\[\large t = \frac{\bar{y}_1
-\bar{y}_2}{SEDM}\]</span> Where <span class="math inline">\(\bar{y}_1\)</span> and <span class="math inline">\(\bar{y}_2\)</span> are the different experimental
groups, and SEDM is the standard error of the difference and is
calculated as:</p>
<p><span class="math display">\[\large SEDM = \sqrt{SEM_1^2 +
SEM^2_2}\]</span></p>
<p>Where subscript 1 and 2 refer to the different experimental groups,
and that the <span class="math inline">\(SEM\)</span> for the <span class="math inline">\(i\)</span><sup>th</sup> group is calculated
as:</p>
<p><span class="math display">\[\large SEM_i =
\frac{s_i}{\sqrt(n_i)}\]</span></p>
<p>Where <span class="math inline">\(s\)</span> and <span class="math inline">\(n\)</span> are the standard deviation and sample
size for the <span class="math inline">\(i\)</span><sup>th</sup> group,
respectively.</p>
<p>Where <span class="math inline">\(i\)</span> represents each group or
sample.</p>
<p>To summarize, we need to group the data by <code>elevation</code>
groups (using <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code>) and then use a
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> call with <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code>, <code><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd()</a></code>
and <code>sqrt(n())</code> functions inside of it. Remember to name your
“new” summary variables and use an <code>=</code> inside the summary
call. After summarizing, we will use a <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> function to
add a new column/variable for the SEM. Finally, I will also modify the
data.frame into a tibble to make the display in future calls easier to
read.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_summary</span> <span class="op">&lt;-</span> <span class="va">tree</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">elevation</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean_density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dens</span><span class="op">)</span>,</span>
<span>            sd_density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">dens</span><span class="op">)</span>,</span>
<span>            sqrt_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sem <span class="op">=</span> <span class="va">sd_density</span> <span class="op">/</span> <span class="va">sqrt_n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># change it from a tibble to a data.frame to make</span></span>
<span>  <span class="co"># next steps easier</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">tree_summary</span></span></code></pre></div>
<pre><code><span><span class="co">##   elevation mean_density sd_density   sqrt_n      sem</span></span>
<span><span class="co">## 1      High          6.1   5.626327 3.162278 1.779201</span></span>
<span><span class="co">## 2       Low         19.2   6.160808 3.162278 1.948219</span></span></code></pre>
<p>Unfortunately there is not an easy way to calculate the t-statistic
using <code>dplyr</code>, so we will need to extract the variables
individually (when we use the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> all of these steps are
automated, but we will continue to calculate it manually so you can see
the process). Likewise, there is not a simple solution to extract
individual variables from a <code>data.frame</code> using
<code>dplyr</code>, so we will use the
<code>data_object[row_number,column_number]</code> syntax to subset the
values into new variables. This is also why we converted
<code>tree_summary</code> into a <code>data.frame</code> in the previous
step.</p>
<p>If we want to extract the mean values, what numbers should we place
in the square brackets in the following code?</p>
<pre><code>tree_summary[?,?]
tree_summary[?,?]</code></pre>
<p>The following code will extract the means and SEMs from the
<code>tree_summary</code> object.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y_high</span> <span class="op">&lt;-</span> <span class="va">tree_summary</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">y_high</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6.1</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y_low</span> <span class="op">&lt;-</span> <span class="va">tree_summary</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">y_low</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 19.2</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sem_high</span> <span class="op">&lt;-</span> <span class="va">tree_summary</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">]</span></span>
<span><span class="va">sem_high</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.779201</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sem_low</span> <span class="op">&lt;-</span> <span class="va">tree_summary</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">5</span><span class="op">]</span></span>
<span><span class="va">sem_low</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.948219</span></span></code></pre>
<p>Now, we will calculate the <span class="math inline">\(t_{statistic}\)</span> using this equation:</p>
<p><span class="math display">\[\large t = \frac{\bar{y}_{low}
-\bar{y}_{high}}{\sqrt{SEM_{low}^2 + SEM^2_{high}}}\]</span></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_stat_trees</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">y_low</span> <span class="op">-</span> <span class="va">y_high</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sem_high</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">sem_low</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">t_stat_trees</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4.965146</span></span></code></pre>
<p>Now that we have a t-statistic, we need to calculate our t-critical
value to compare it with and decide if we can formally reject or fail to
reject our null hypothesis. To calculate the t-critical value, we will
once again use <code><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt()</a></code> funciton. Our degrees of freedom here
is 18 (total n = 20, but we need to subtract 1 for each group: 20 - (1 +
1) = 18).</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_crit_trees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="fl">0.025</span>, df <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span>
<span><span class="va">t_crit_trees</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -2.100922</span></span></code></pre>
<p>To compare our t-critical and t-statistic, we will once again use the
absolute values to avoid mixing up our signs.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">t_stat_trees</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">t_crit_trees</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">two_samp_p_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">t_stat_trees</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">18</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span></span>
<span><span class="va">two_samp_p_val</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.0001001215</span></span></code></pre>
<p>When you have a really low p-value like this, it’s best to round
instead of reporting the full value. Reporting the exact value adds a
false sense of specificity. The three levels of significance are
generally p &lt; 0.05, p &lt; 0.01, and p &lt; 0.001. Here we would just
say that the p-value is &lt; 0.001.</p>
<div class="section level4">
<h4 id="interpretation-1">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation-1"></a>
</h4>
<p>Based on the data, we estimate that the mean (<span class="math inline">\(\pm\)</span> SE) tree density at high and low
elevations is 6.1 (<span class="math inline">\(\pm\)</span> 1.78) and
19.2 (<span class="math inline">\(\pm\)</span> 1.95), respectively.
Likewise, we can reject the null hypothesis and accept the alternative
that tree densities differ based on elevation (<span class="math inline">\(t_{statistic} = 4.97, df = 18, p &lt;
0.001\)</span>).</p>
</div>
</div>
<div class="section level3">
<h3 id="sample-t-test-using-lm">2-sample t-test using <code>lm()</code><a class="anchor" aria-label="anchor" href="#sample-t-test-using-lm"></a>
</h3>
<p>The hand calculations for a 2-sample t-test are tedious. Luckily we
can run the same analysis in just a few lines of code using the
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">two_sample_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">dens</span> <span class="op">~</span> <span class="va">elevation</span>, data <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">two_sample_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = dens ~ elevation, data = tree)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">## -6.100 -4.125 -1.700  2.125 12.900 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)     6.100      1.866   3.270  0.00426 ** </span></span>
<span><span class="co">## elevationLow   13.100      2.638   4.965  0.00010 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 5.9 on 18 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.578,  Adjusted R-squared:  0.5545 </span></span>
<span><span class="co">## F-statistic: 24.65 on 1 and 18 DF,  p-value: 0.0001001</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="interpreting-lm-output">Interpreting <code>lm()</code> output<a class="anchor" aria-label="anchor" href="#interpreting-lm-output"></a>
</h3>
<p>The summary of the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> has a lot of information. What
we are primarily focused on here is the <code>elevationLow</code> row.
The Estimate represents the <em>difference</em> between the two
elevation groups. (Since “Low” is in the name, we can deduce that the
<code>(Intercept)</code> is the estimated value for the other elevation
group, “High”.) The t-value (4.96) and the p-value (&lt; 0.001) match
what we calculated by hand above. There is also an R^2 value, which
tells us how much of the variation in response variable (density) is
explained by the predictor variable (elevation). In this case,
approximately 55% of the variation is explained by elevation (This is
rather high for one categorical value, maybe because I simulated these
values).</p>
<div class="section level4">
<h4 id="you-should-now-be-able-to-complete-problem-2-in-the-homework-assignment">
<strong>You should now be able to complete problem 2 in the homework
assignment</strong><a class="anchor" aria-label="anchor" href="#you-should-now-be-able-to-complete-problem-2-in-the-homework-assignment"></a>
</h4>
</div>
</div>
</div>
<div class="section level2">
<h2 id="paired-t-tests-herbicide-treatments">Paired t-tests: Herbicide Treatments<a class="anchor" aria-label="anchor" href="#paired-t-tests-herbicide-treatments"></a>
</h2>
<div class="section level3">
<h3 id="data-1">Data<a class="anchor" aria-label="anchor" href="#data-1"></a>
</h3>
<p>For this section of the lab, you will need to download the
<code>caterpillar.csv</code> file from D2L.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">caterpillar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"data/caterpillar.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Briefly, this is data from a controlled experiment looking herbicide
effects on non-target caterpillars. Twelve plots were split, and each
side was randomly assigned as a control or herbicide treatment. Each
plot is an experimental unit and the treatments are “paired” within
it.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">caterpillar</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   plot_number    treatment caterpillar_count</span></span>
<span><span class="co">## 1           1      control                23</span></span>
<span><span class="co">## 2           1 bt_herbicide                19</span></span>
<span><span class="co">## 3           2      control                18</span></span>
<span><span class="co">## 4           2 bt_herbicide                18</span></span>
<span><span class="co">## 5           3      control                29</span></span>
<span><span class="co">## 6           3 bt_herbicide                24</span></span></code></pre>
<p>Plots were arranged in pairs at 12 different locations
(<code>plot_number</code>). One plot in each pair was randomly selected
for treatment with the microbial pesticide <em>Bacillus
thuringiensis</em> (Bt) (<code>treatment</code>). The other plot was
untreated and acts as a control. Surveys of non target caterpillars were
performed by counting caterpillars on samples of 10,000 leaves on each
plot (<code>caterpillar_count</code>).</p>
<p>Because the plots were paired, what we’re interested in is the
difference in <code>caterpillar_count</code> between
<code>bt_herbicide</code> and <code>control</code> plots. If the
herbicide had no effect, then we would expect both plot types to have
the same number of caterpillars. In other, words, the difference in
counts between each plot would be 0.</p>
<p>Therefore, the null hypothesis is that the average difference (<span class="math inline">\(\mu_d\)</span>) between the two groups is 0.</p>
<p>For a paired t-test, the null hypothesis is that the average
difference between the two groups is 0.</p>
<p><span class="math display">\[H_0:\large \mu_D = 0\]</span> And our
alternative hypothesis is that there is a difference between the two
groups, or:</p>
<p><span class="math display">\[H_A:\large \mu_D \ne 0\]</span></p>
<p>For this, we need to calculate the difference between the two
treatments. The way that this data is organized, that means that we need
to subtract row 2 from row 1, row 4 from row 3, etc. Based on the
<code>dplyr</code> functions we’ve learned so far, there is no simple
solution apparent.</p>
<p>Essentially, we calculate a one-sample t-test on the
<em>differences</em> between groups. If the groups are the same, there
should be no difference (i.e., difference = 0). If the groups are not
the same, there should be a <em>difference</em>.</p>
<p>We need to calculate the difference between the two treatments within
each plot or experimental unit. If we look at the way the data is
organized, there is not a simple solution using <code>dplyr</code>
functions.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">caterpillar</span></span></code></pre></div>
<pre><code><span><span class="co">##    plot_number    treatment caterpillar_count</span></span>
<span><span class="co">## 1            1      control                23</span></span>
<span><span class="co">## 2            1 bt_herbicide                19</span></span>
<span><span class="co">## 3            2      control                18</span></span>
<span><span class="co">## 4            2 bt_herbicide                18</span></span>
<span><span class="co">## 5            3      control                29</span></span>
<span><span class="co">## 6            3 bt_herbicide                24</span></span>
<span><span class="co">## 7            4      control                22</span></span>
<span><span class="co">## 8            4 bt_herbicide                23</span></span>
<span><span class="co">## 9            5      control                33</span></span>
<span><span class="co">## 10           5 bt_herbicide                31</span></span>
<span><span class="co">## 11           6      control                20</span></span>
<span><span class="co">## 12           6 bt_herbicide                22</span></span>
<span><span class="co">## 13           7      control                17</span></span>
<span><span class="co">## 14           7 bt_herbicide                16</span></span>
<span><span class="co">## 15           8      control                25</span></span>
<span><span class="co">## 16           8 bt_herbicide                23</span></span>
<span><span class="co">## 17           9      control                27</span></span>
<span><span class="co">## 18           9 bt_herbicide                24</span></span>
<span><span class="co">## 19          10      control                30</span></span>
<span><span class="co">## 20          10 bt_herbicide                26</span></span>
<span><span class="co">## 21          11      control                25</span></span>
<span><span class="co">## 22          11 bt_herbicide                24</span></span>
<span><span class="co">## 23          12      control                27</span></span>
<span><span class="co">## 24          12 bt_herbicide                28</span></span></code></pre>
<div class="section level4">
<h4 id="data-wrangling">Data Wrangling<a class="anchor" aria-label="anchor" href="#data-wrangling"></a>
</h4>
<p>Luckily, there is a special helper function called
<code><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff()</a></code> that we can use inside of <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code>.
First, we need to group the data so that it uses the correct numbers.
Here, we want to know what the effect is within plots, so we will use
<code>group_by(plot_number)</code>.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">caterpillar</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">plot_number</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>difference <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">caterpillar_count</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 24 × 4</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   plot_number [12]</span></span></span>
<span><span class="co">##    plot_number treatment    caterpillar_count difference</span></span>
<span><span class="co">##          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>           1 control                     23          4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>           1 bt_herbicide                19          4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>           2 control                     18          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>           2 bt_herbicide                18          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>           3 control                     29          5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>           3 bt_herbicide                24          5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>           4 control                     22         -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>           4 bt_herbicide                23         -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>           5 control                     33          2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>           5 bt_herbicide                31          2</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 14 more rows</span></span></span></code></pre>
<p>We can see that this correctly calculated the difference between
<code>treatment</code> types <em>within</em> <code>plot_number</code>,
but it has doubled the number of observations (essentially giving a
value for each plot:treatment combination, when we only want one
observation per plot). We can modify our data pipeline above to
<code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code> the two columns we are interested in
(<code>plot</code>, and <code>difference</code>) and then use
<code><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct()</a></code> to only keep unique, individual observations. In
this step we will also save the output of this data pipeline as a new
object which we can use for our formal analysis.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cat_diff</span> <span class="op">&lt;-</span> <span class="va">caterpillar</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">plot_number</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>difference <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">caterpillar_count</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">plot_number</span>, <span class="va">difference</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">cat_diff</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 12 × 2</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   plot_number [12]</span></span></span>
<span><span class="co">##    plot_number difference</span></span>
<span><span class="co">##          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>           1          4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>           2          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>           3          5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>           4         -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>           5          2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>           6         -<span style="color: #BB0000;">2</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>           7          1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>           8          2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>           9          3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>          10          4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>          11          1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span>          12         -<span style="color: #BB0000;">1</span></span></span></code></pre>
<p><strong>REMEMBER</strong> that when you are developing and working
out a pipeline like this you should add only one command at a time. For
example:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first step</span></span>
<span><span class="va">caterpillar</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">plot_number</span><span class="op">)</span></span>
<span><span class="co"># second step</span></span>
<span><span class="va">caterpillar</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">plot_number</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>difference <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">caterpillar_count</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># third step</span></span>
<span><span class="va">caterpillar</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">plot_number</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>difference <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">caterpillar_count</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">plot_number</span>, <span class="va">difference</span><span class="op">)</span></span>
<span><span class="co"># fourth step</span></span>
<span><span class="va">caterpillar</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">plot_number</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>difference <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">caterpillar_count</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">plot_number</span>, <span class="va">difference</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Once you have the desired output, THEN save it as a new object</span></span>
<span><span class="va">cat_diff</span> <span class="op">&lt;-</span> <span class="va">caterpillar</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">plot_number</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>difference <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">caterpillar_count</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">plot_number</span>, <span class="va">difference</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h3>
<p>Now that we have our a data object which includes the difference
between treatments within each plot, we can formally test our hypotheses
above using a linear model analysis.</p>
<p>The structure of the t-test for paired data is:</p>
<p><span class="math display">\[\large t = \frac{\bar{y}_{diff} -
0}{SD_{diff} / \sqrt(n)}\]</span></p>
<p>For this section, we will skip the manual calculations and just use
the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function. Also recall that the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>
function uses a more accurate “pooled” estimate of the standard
deviation of the difference which is more tedious to calculate. Another
good reason to use the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function - less chance to make
mistakes!</p>
<p>But once again let’s start by plotting our data.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">cat_diff</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">difference</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"dodgerblue"</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_08_t-tests_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>Because we already calculated the difference between the two
treatments, we are fitting an “intercept-only” model as in the one
sample t-test at the beginning of lab. However, in this case, our value
of interest (<span class="math inline">\(\mu_0\)</span>) is 0, which is
the default in the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function, so we do not need to
subtract anything from the response side of the formula.</p>
<p>We can quickly plot these differences to get an idea of the overall
effect.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cat_diff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">difference</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"mediumorchid1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_08_t-tests_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<p>In this plot, the reference value (<span class="math inline">\(\mu_0
= 0\)</span>) is represented with the dashed line, and is right on the
edge of the upper quantile (75th percentile). It’s difficult to tell if
the differences are close enough to zero or not, so we will need to
calculate a formal statistical test.</p>
<p>Recall that we calculate a paired t-test statistic with the following
formula:</p>
<p><span class="math display">\[\large t = \frac{\bar{y}_{Diff} -
0}{SED}\]</span></p>
<p>Here, SED is the standard error of the <em>difference</em>. For this
example, we will skip the hand calculation and jump straight to using
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>. We already have the differences stored in the
<code>cat_diff</code> object. We will use that object to calculate a
one-sample t-test. Using the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function, a one sample
t-test is the same as an intercept-only model.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paired_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">difference</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">cat_diff</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">paired_fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = difference ~ 1, data = cat_diff)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">##  -3.50  -1.75   0.00   1.75   3.50 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co">## (Intercept)   1.5000     0.6455   2.324   0.0403 *</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 2.236 on 11 degrees of freedom</span></span></code></pre>
<p>Our estimated intercept (<span class="math inline">\(\pm\)</span> SE)
is 1.5 <span class="math inline">\(\pm\)</span> 0.65, and we can reject
the null hypothesis and conclude that there was a difference in the
number of caterpillars between the two treatments (<span class="math inline">\(t_{statistic} = 2.32, df = 11, p =
0.04\)</span>).</p>
<div class="section level4">
<h4 id="you-should-now-be-able-to-complete-porblem-3-in-the-homework-assignment-">
<strong>You should now be able to complete porblem 3 in the homework
assignment.</strong><a class="anchor" aria-label="anchor" href="#you-should-now-be-able-to-complete-porblem-3-in-the-homework-assignment-"></a>
</h4>
</div>
</div>
<div class="section level3">
<h3 id="lm-analysis-without-data-wrangling">
<code>lm()</code> analysis without data wrangling<a class="anchor" aria-label="anchor" href="#lm-analysis-without-data-wrangling"></a>
</h3>
<p>This section is supplementary and is not strictly required to
complete HW 08.</p>
<p>For completeness, and to match the example presented in Ch. 6 of
<em>The New Statistics with R</em>, we could run a paired t-test on the
original <code>caterpillar</code> data object. In this case, we would
designate our response variable <code>caterpillar_count</code> and two
predictor variables: <code>treatment</code> and
<code>plot_number</code>. In this case, we are assessing the effect of
treatment while controlling for the plot_number. This is also known as a
“blocking” variable. We will return to analyses with multiple predictor
or blocking variables when we discuss ANOVA and linear regression
analyses.</p>
<p>Note that we modify the data to treat <code>plot_number</code> as a
categorical variable using the <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor()</a></code> function.
Becasue the variable is currently an integer, the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>
treats it as continuous which is not in fact correct. It’s always
important to think about the class or type of your individual variables
to ensure you are running the analysis that you think you are
running.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">caterpillar_count</span> <span class="op">~</span> </span>
<span>             <span class="va">treatment</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">plot_number</span><span class="op">)</span>,</span>
<span>           data <span class="op">=</span> <span class="va">caterpillar</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = caterpillar_count ~ treatment + as.factor(plot_number), </span></span>
<span><span class="co">##     data = caterpillar)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">## -1.750 -0.875  0.000  0.875  1.750 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                            Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)               2.025e+01  1.164e+00  17.402 2.37e-09 ***</span></span>
<span><span class="co">## treatmentcontrol          1.500e+00  6.455e-01   2.324  0.04031 *  </span></span>
<span><span class="co">## as.factor(plot_number)2  -3.000e+00  1.581e+00  -1.897  0.08433 .  </span></span>
<span><span class="co">## as.factor(plot_number)3   5.500e+00  1.581e+00   3.479  0.00516 ** </span></span>
<span><span class="co">## as.factor(plot_number)4   1.500e+00  1.581e+00   0.949  0.36316    </span></span>
<span><span class="co">## as.factor(plot_number)5   1.100e+01  1.581e+00   6.957 2.40e-05 ***</span></span>
<span><span class="co">## as.factor(plot_number)6  -2.241e-14  1.581e+00   0.000  1.00000    </span></span>
<span><span class="co">## as.factor(plot_number)7  -4.500e+00  1.581e+00  -2.846  0.01591 *  </span></span>
<span><span class="co">## as.factor(plot_number)8   3.000e+00  1.581e+00   1.897  0.08433 .  </span></span>
<span><span class="co">## as.factor(plot_number)9   4.500e+00  1.581e+00   2.846  0.01591 *  </span></span>
<span><span class="co">## as.factor(plot_number)10  7.000e+00  1.581e+00   4.427  0.00102 ** </span></span>
<span><span class="co">## as.factor(plot_number)11  3.500e+00  1.581e+00   2.214  0.04891 *  </span></span>
<span><span class="co">## as.factor(plot_number)12  6.500e+00  1.581e+00   4.111  0.00173 ** </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 1.581 on 11 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.9412, Adjusted R-squared:  0.8771 </span></span>
<span><span class="co">## F-statistic: 14.68 on 12 and 11 DF,  p-value: 4.544e-05</span></span></code></pre>
<p>This output is much more crowded and difficult to interpret as it
automatically runs a test comparing every <code>plot_number</code> to
<code>plot_number == 1</code>. However, if we ignore those tests and
focus on the second line (<code>treatmentcontrol</code>), we can see
that it is the same results as our <code>paired_fit</code> object
above.</p>
<p>Our estimated intercept coefficient is -1.5, and the standard error
of this estimate is 0.6455. The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> output also
includes a t<sub>statistic</sub> (<code>t value</code>) of -2.324. The
output does not give us our t<sub>critical</sub> value, but it does
gives us the p-value. Here, the p-value is 0.0403, which is less than
our <span class="math inline">\(\alpha\)</span> value of 0.05. Hence, we
reject the null hypothesis and conclude that there is a difference in
treatment values.</p>
<div class="section level4">
<h4 id="you-should-now-be-able-to-complete-problem-3-in-the-homework-assignment">
<strong>You should now be able to complete problem 3 in the homework
assignment</strong><a class="anchor" aria-label="anchor" href="#you-should-now-be-able-to-complete-problem-3-in-the-homework-assignment"></a>
</h4>
</div>
</div>
<div class="section level3">
<h3 id="coda">Coda<a class="anchor" aria-label="anchor" href="#coda"></a>
</h3>
<p>This concludes lab 08</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Justin Pomeranz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

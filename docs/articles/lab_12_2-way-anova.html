<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 12: 2-Way ANOVA • ENVS475</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 12: 2-Way ANOVA">
<meta property="og:description" content="ENVS475">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ENVS475</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2024.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fa fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fa fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-desktop"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/lecture_01/lecture_01.html">Lecture 01: Course introduction</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_03_basic-stats/lecture_03_basic-stats.html">Lecture 03: Basic Statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_05_estimation/lecture_05_estimation.html">Lecture 05: Point Estimates</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_06_intro-models/lecture_06_intro-models.html">Lecture 06: Intro to Models</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_07_t-tests/lecture_07_t-tests.html">Lecture 07: t-tests</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_10_anova/lecture_10_anova.html">Lecture 10: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_11_factorial/lecture_11_factorial_anova.pdf">Lecture 11: Factorial</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_12_two-way/lecture_12_two-way.pdf">Lecture 12: Factorial</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_13_regression/lecture_13_regression.pdf">Lecture 13: Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop-code"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab_01_projects.html">lab 01: projects</a>
    </li>
    <li>
      <a href="../articles/lab_02_intro_to_R.html">lab 02: Intro to R</a>
    </li>
    <li>
      <a href="../articles/lab_03_normal-distributions.html">lab 03: Normal Distributions</a>
    </li>
    <li>
      <a href="../articles/lab_04a_dplyr.html">lab 04a: dplyr</a>
    </li>
    <li>
      <a href="../articles/lab_04b_ggplot.html">lab 04b: ggplot</a>
    </li>
    <li>
      <a href="../articles/lab_05_point-estimates.html">lab 05: point estimates</a>
    </li>
    <li>
      <a href="../articles/lab_06_linear-models.html">lab 06: linear models</a>
    </li>
    <li>
      <a href="../articles/lab_08_t-tests.html">lab 07: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab_07_intro_markdown.html">lab 09: intro to R markdown</a>
    </li>
    <li>
      <a href="../articles/lab_10_anova.html">lab 10: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab_11_factorial-anova.html">lab 11: Factorial ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab_12_2-way-anova.html">lab 12: 2-way anova</a>
    </li>
    <li>
      <a href="../articles/lab_13_linear-regression.html">lab 13: Linear Regression</a>
    </li>
    <li>
      <a href="../articles/lab_14_ANCOVA.html">lab 14: ANCOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-folder-open"></span>
     
    Homework
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework/HW_01.html">Homework 01 setup</a>
    </li>
    <li>
      <a href="../articles/homework/HW_02_intro_R.html">Homework 02 Intro to R</a>
    </li>
    <li>
      <a href="../articles/homework/HW_03_normal-distributions.html">Homework 03 Normal Distributions</a>
    </li>
    <li>
      <a href="../articles/homework/HW_04_dplyr_ggplot.html">Homework 04 dplyr + ggplot2</a>
    </li>
    <li>
      <a href="../articles/homework/HW_05_point-estimates.html">Homework 05 Point Estimates</a>
    </li>
    <li>
      <a href="../articles/homework/HW_06_linear_models.html">Homework 06 Intro to Linear Models</a>
    </li>
    <li>
      <a href="../articles/homework/HW_07_t-tests.html">Homework 07 t-tests</a>
    </li>
    <li>
      <a href="../articles/homework/HW_09_markdown.html">Homework 09 R Markdown</a>
    </li>
    <li>
      <a href="../articles/homework/HW_10_ANOVA.html">Homework 10 ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_11_factorial.html">Homework 11 Factorial ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_12_two-way-ANOVA.html">Homework 12 2-way ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_13_linear-regression.html">Homework 13 Linear Regression</a>
    </li>
    <li>
      <a href="../articles/homework/HW_14_ANCOVA.html">Homework 14 ANCOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/term-list.html">Terms and Definitions</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 12: 2-Way ANOVA</h1>
            <h3 data-toc-skip class="subtitle">ENVS475: Experimental
Analysis and Design</h3>
            
            <h4 data-toc-skip class="date">Spring, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Jpomz/ENVS475/blob/HEAD/vignettes/articles/lab_12_2-way-anova.Rmd" class="external-link"><code>vignettes/articles/lab_12_2-way-anova.Rmd</code></a></small>
      <div class="hidden name"><code>lab_12_2-way-anova.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="about">About<a class="anchor" aria-label="anchor" href="#about"></a>
</h2>
<p>This lab will demonstrate how to perform a two-way ANOVA with
interaction in R. This includes checking assumptions, fitting the linear
model, interpreting and visualizing the results.</p>
</div>
<div class="section level2">
<h2 id="preliminaries">Preliminaries<a class="anchor" aria-label="anchor" href="#preliminaries"></a>
</h2>
<div class="section level4">
<h4 id="packages">Packages<a class="anchor" aria-label="anchor" href="#packages"></a>
</h4>
<p>For this lab, we will be using the <code>dplyr</code> and
<code>ggplot2</code> packages. Make sure both packages are installed on
your computer, and then run the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h4>
<p>We will use the <code>ToothGrowth</code> data which comes with R.
Load the data by running the following command:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ToothGrowth"</span><span class="op">)</span></span></code></pre></div>
<p><code>ToothGrowth</code> contains data examining the effect of
varying the dose (<code>dose</code>) of two supplements
(<code>supp</code>) on the length (<code>len</code>) of teeth in Guinea
Pigs. Run <code><a href="https://rdrr.io/r/datasets/ToothGrowth.html" class="external-link">?ToothGrowth</a></code> to learn more about the data.</p>
</div>
</div>
<div class="section level2">
<h2 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h2>
<p>Let’s look at the full data, and see what the treatment levels
are.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ToothGrowth</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "len"  "supp" "dose"</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">ToothGrowth</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 60  3</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ToothGrowth</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    len supp dose</span></span>
<span><span class="co">## 1  4.2   VC  0.5</span></span>
<span><span class="co">## 2 11.5   VC  0.5</span></span>
<span><span class="co">## 3  7.3   VC  0.5</span></span>
<span><span class="co">## 4  5.8   VC  0.5</span></span>
<span><span class="co">## 5  6.4   VC  0.5</span></span>
<span><span class="co">## 6 10.0   VC  0.5</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">ToothGrowth</span>, <span class="va">supp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   supp</span></span>
<span><span class="co">## 1   VC</span></span>
<span><span class="co">## 2   OJ</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">ToothGrowth</span>, <span class="va">dose</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   dose</span></span>
<span><span class="co">## 1  0.5</span></span>
<span><span class="co">## 2  1.0</span></span>
<span><span class="co">## 3  2.0</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">ToothGrowth</span>, <span class="va">supp</span>, <span class="va">dose</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   supp dose</span></span>
<span><span class="co">## 1   VC  0.5</span></span>
<span><span class="co">## 2   VC  1.0</span></span>
<span><span class="co">## 3   VC  2.0</span></span>
<span><span class="co">## 4   OJ  0.5</span></span>
<span><span class="co">## 5   OJ  1.0</span></span>
<span><span class="co">## 6   OJ  2.0</span></span></code></pre>
<p>For this analysis, we have two <em>factors</em> (supp and dose). The
<strong>supp</strong> factor has two levels: VC, and OJ and the
<strong>dose</strong> factor has three levels: 0.5, 1.0, and 2.0.</p>
<div class="section level4">
<h4 id="wrangle-variables-to-be-a-factor">Wrangle variables to be a <strong>Factor</strong><a class="anchor" aria-label="anchor" href="#wrangle-variables-to-be-a-factor"></a>
</h4>
<p>You may have noticed that the <code>dose</code> variable is a class
<code>dbl</code>. If we plug this into the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function, R
will treat this as continuous and will give us a different result. In
ANOVA, we want to analyze the data based on categories. We can chnage
the <code>dose</code> variable to an ordered factor with the following
code. We will also be changing the name of the data object to
<code>dat</code> to have less typing to do.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">ToothGrowth</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dose</span>,</span>
<span>                       levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                       labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D0.5"</span>, <span class="st">"D1"</span>, <span class="st">"D2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can also use the <code>tab()</code> function to see how many
observations are in each group:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">ToothGrowth</span><span class="op">$</span><span class="va">supp</span>, <span class="va">ToothGrowth</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     </span></span>
<span><span class="co">##      0.5  1  2</span></span>
<span><span class="co">##   OJ  10 10 10</span></span>
<span><span class="co">##   VC  10 10 10</span></span></code></pre>
<p>We can see that there are 10 observations in each combination of all
levels for both factors. We call this a completely balanced ANOVA
design.</p>
</div>
<div class="section level3">
<h3 id="plot-data">Plot data<a class="anchor" aria-label="anchor" href="#plot-data"></a>
</h3>
<p>Let’s start by plotting all of the data. We will save time and
consider all the grouping variables.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dose</span>,</span>
<span>           y <span class="op">=</span> <span class="va">len</span>,</span>
<span>           color <span class="op">=</span> <span class="va">supp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_12_2-way-anova_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="section level4">
<h4 id="interaction-plots">Interaction plots<a class="anchor" aria-label="anchor" href="#interaction-plots"></a>
</h4>
<p>We can estimate the effects based on the boxplot above, but an
interaction plot is usually more illustrative.</p>
</div>
<div class="section level4">
<h4 id="base-r-plotting">Base R Plotting<a class="anchor" aria-label="anchor" href="#base-r-plotting"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>, </span>
<span>     <span class="fu"><a href="https://rdrr.io/r/stats/interaction.plot.html" class="external-link">interaction.plot</a></span><span class="op">(</span><span class="va">dose</span>, <span class="va">supp</span>, <span class="va">len</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_12_2-way-anova_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="ggplot">
<code>ggplot</code><a class="anchor" aria-label="anchor" href="#ggplot"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dose</span>,</span>
<span>           y <span class="op">=</span> <span class="va">len</span>,</span>
<span>           color <span class="op">=</span> <span class="va">supp</span>,</span>
<span>           group <span class="op">=</span> <span class="va">supp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"line"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_12_2-way-anova_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="check-pre-analysis-assumptions">Check pre-analysis assumptions<a class="anchor" aria-label="anchor" href="#check-pre-analysis-assumptions"></a>
</h3>
<div class="section level4">
<h4 id="assumption-equal-variance">Assumption: equal variance<a class="anchor" aria-label="anchor" href="#assumption-equal-variance"></a>
</h4>
<p><img src="lab_12_2-way-anova_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>These data look to have approximately equal variation across the
treatment groups. The <code>D1:VC</code> and <code>D2:OJ</code> look to
have slightly less variation, but this is probably close enough.</p>
</div>
<div class="section level4">
<h4 id="assumptions-normality-of-residuals">Assumptions: Normality of residuals<a class="anchor" aria-label="anchor" href="#assumptions-normality-of-residuals"></a>
</h4>
<div class="section level5">
<h5 id="qq-plot">QQ-plot<a class="anchor" aria-label="anchor" href="#qq-plot"></a>
</h5>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">len</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">stat_qq</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">stat_qq_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_12_2-way-anova_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Most of the observations (points) fall close to the reference line.
There’s a few that are off near the low and high end of the data, but
this should be ok.</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="two-way-anova">Two-way ANOVA<a class="anchor" aria-label="anchor" href="#two-way-anova"></a>
</h2>
<div class="section level3">
<h3 id="hypotheses">Hypotheses<a class="anchor" aria-label="anchor" href="#hypotheses"></a>
</h3>
<div class="section level4">
<h4 id="main-effect-of-supplement-supp">Main effect of supplement (<code>supp</code>)<a class="anchor" aria-label="anchor" href="#main-effect-of-supplement-supp"></a>
</h4>
<p><span class="math display">\[ H0: \text{There is NO effect of
supplement on tooth growth} \]</span></p>
<p><span class="math display">\[HA: \text{There IS AN EFFECT of
supplement on tooth growth}\]</span></p>
</div>
<div class="section level4">
<h4 id="main-effect-of-dose">Main effect of (<code>dose</code>)<a class="anchor" aria-label="anchor" href="#main-effect-of-dose"></a>
</h4>
<p>Null and alternative hypotheses:</p>
<p><span class="math display">\[H0: \text{There is NO effect of Dose on
tooth growth}\]</span></p>
<p><span class="math display">\[HA: \text{There IS AN EFFECT of Dose on
tooth growth}\]</span></p>
</div>
<div class="section level4">
<h4 id="interactive-effect-of-dosesupp">Interactive effect of <code>dose:supp</code><a class="anchor" aria-label="anchor" href="#interactive-effect-of-dosesupp"></a>
</h4>
<p><span class="math display">\[H0: \text{The effect of one factor DOES
NOT depend on the other factor}\]</span> <span class="math display">\[H0: \text{The effect of one factor DOES depend on
the other factor}\]</span></p>
</div>
</div>
<div class="section level3">
<h3 id="two-way-anova-with-lm">Two-way ANOVA with <code>lm()</code><a class="anchor" aria-label="anchor" href="#two-way-anova-with-lm"></a>
</h3>
<p>Let’s first fit a linear model to the data.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tooth_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">len</span> <span class="op">~</span> <span class="va">supp</span> <span class="op">*</span> <span class="va">dose</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span><span class="va">tooth_lm</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = len ~ supp * dose, data = dat)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##   (Intercept)         suppVC         doseD1         doseD2  suppVC:doseD1  </span></span>
<span><span class="co">##         13.23          -5.25           9.47          12.83          -0.68  </span></span>
<span><span class="co">## suppVC:doseD2  </span></span>
<span><span class="co">##          5.33</span></span></code></pre>
<div class="section level4">
<h4 id="assumption-equal-variance-of-residuals">Assumption: Equal variance of residuals<a class="anchor" aria-label="anchor" href="#assumption-equal-variance-of-residuals"></a>
</h4>
<p>Before we look at the results, let’s check our post-model fit
assumption with a fitted vs. residuals plot.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tooth_lm</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.fitted</span>, y <span class="op">=</span> <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>      position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span></span>
<span>        width <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>        height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_12_2-way-anova_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>In this plot, the absolute magnitude of the maximum and minimum
y-values are approximately the same (~ -7.5, ~ 7.5), although there are
a couple of points above the 1.25 region. There may be slightly more
variation on the right side (points are further from the line). However,
there is no clear pattern in the spread of the points, so this looks
OK.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="anova-table">ANOVA table<a class="anchor" aria-label="anchor" href="#anova-table"></a>
</h2>
<p>In order to get the statistical values for the ANOVA table, we need
to use the <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> function on the model fit object.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">tooth_lm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Analysis of Variance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: len</span></span>
<span><span class="co">##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span><span class="co">## supp       1  205.35  205.35  15.572 0.0002312 ***</span></span>
<span><span class="co">## dose       2 2426.43 1213.22  92.000 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## supp:dose  2  108.32   54.16   4.107 0.0218603 *  </span></span>
<span><span class="co">## Residuals 54  712.11   13.19                      </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p>You can see that we know have a row for each of the main factors and
a row for the interaction effect (<code>supp:dose</code>) as well as a
fourth row for the residuals (unexplained variation).</p>
<p>We interpret the F-value and p-value for each factor as before. Our
interpretation of the main effects is the same as before. For example,
there is a significant main effect of supplement (<code>supp</code>) and
dose (<code>dose</code>).</p>
<p>We can now also make a statement of the statistical significance for
the interactive effect. In this case, the p-value for the
<code>supp:dose</code> interaction is p = 0.02 and this is less than our
<span class="math inline">\(\alpha = 0.05\)</span> cutoff, so there
<em>is an interactive effect</em>. In other words, the effect of
supplement depends on the dose applied (or the effect of the dose
depends on the supplement type). <strong>Reminder</strong> do not try
and interpret what the interaction effect is, just say that there is
one.</p>
<div class="section level3">
<h3 id="anova-interpretation">ANOVA Interpretation<a class="anchor" aria-label="anchor" href="#anova-interpretation"></a>
</h3>
<p>Remember that the hypotheses for ANOVA are either that all means are
the same, or that at least one was different. ANOVA can only tell us
that there is a difference. Therefore, our interpretation would look
something like this:</p>
<blockquote>
<p>Based on a 2-way ANOVA with interaction, there were significant main
effects of supplement (<span class="math inline">\(F_{1, 54}= 15.572, p
&lt; 0.001\)</span>) and dose (<span class="math inline">\(F_{2, 54}=
92, p &lt; 0.001\)</span>). Furthermore, there was a significnat
interaction (<span class="math inline">\(F_{2, 54}= 4.1, p =
0.02\)</span>) which means that the effect of one factor depended on the
level of the other factor.</p>
</blockquote>
<div class="section level4">
<h4 id="relate-anova-table-to-intercation-plot">Relate ANOVA table to intercation plot<a class="anchor" aria-label="anchor" href="#relate-anova-table-to-intercation-plot"></a>
</h4>
<p><img src="lab_12_2-way-anova_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="section level5">
<h5 id="main-effect-of-supp">Main effect of <code>supp</code><a class="anchor" aria-label="anchor" href="#main-effect-of-supp"></a>
</h5>
<p>“Average” the y-values for each line individually across the
x-values. Overall, the average of the red line is not equal to the
average of the blue line: Significant main effect.</p>
</div>
<div class="section level5">
<h5 id="main-effect-of-dose-1">Main effect of <code>dose</code><a class="anchor" aria-label="anchor" href="#main-effect-of-dose-1"></a>
</h5>
<p>“Average” the y-values for each x-category across the lines. The
average for <code>D0.5</code> is low, and <code>D1</code> is medium,
while <code>D2</code> is high. This means we have a significant effect
of dose.</p>
</div>
<div class="section level5">
<h5 id="interaction">Interaction<a class="anchor" aria-label="anchor" href="#interaction"></a>
</h5>
<p>Look at the lines to see if they are parallel or if they have a
different slope. Both lines are parallel at the lower doses, but the
slope changes between <code>D1</code> and <code>D2</code>. This means
there is a significant interaction.</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="multiple-comparisons">Multiple Comparisons<a class="anchor" aria-label="anchor" href="#multiple-comparisons"></a>
</h2>
<p>In order to see <em>which</em> means are different, we can view the
summary output from the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> model, as well as calculate
Tukey’s HSD.</p>
<div class="section level3">
<h3 id="lm-summary">
<code>lm()</code> summary<a class="anchor" aria-label="anchor" href="#lm-summary"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tooth_lm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = len ~ supp * dose, data = dat)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">##  -8.20  -2.72  -0.27   2.65   8.27 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)     13.230      1.148  11.521 3.60e-16 ***</span></span>
<span><span class="co">## suppVC          -5.250      1.624  -3.233  0.00209 ** </span></span>
<span><span class="co">## doseD1           9.470      1.624   5.831 3.18e-07 ***</span></span>
<span><span class="co">## doseD2          12.830      1.624   7.900 1.43e-10 ***</span></span>
<span><span class="co">## suppVC:doseD1   -0.680      2.297  -0.296  0.76831    </span></span>
<span><span class="co">## suppVC:doseD2    5.330      2.297   2.321  0.02411 *  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 3.631 on 54 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.7937, Adjusted R-squared:  0.7746 </span></span>
<span><span class="co">## F-statistic: 41.56 on 5 and 54 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<p>The summary output with multiple-levels of a factor and an
interaction becomes much more complicated. However, if we take them one
at-a-time we can see there’s not much different.</p>
<p>The intercept is the mean estimate for our reference group, which in
this case is the OJ supplement at D0.5. We will need to keep this in
mind when we look at all of the other coefficient estimates.</p>
<p>Other Coefficients:</p>
<ul>
<li><p><code>suppVC</code> = <code>OJ:D0.5</code> -
<code>VC:D0.5</code></p></li>
<li><p><code>doseD1</code> = <code>OJ:D0.5</code> -
<code>OJ:D1</code></p></li>
<li><p><code>doseD2</code> = <code>OJ:D0.5</code> -
<code>OJ:D2</code></p></li>
<li><p><code>suppVC:doseD1</code> = <code>OJ:D0.5</code> -
<code>VC:D1</code></p></li>
<li><p><code>suppVC:doseD2</code> = <code>OJ:D0.5</code> -
<code>VC:D2</code></p></li>
</ul>
<div class="section level4">
<h4 id="interpretation-of-p-values">Interpretation of p-values<a class="anchor" aria-label="anchor" href="#interpretation-of-p-values"></a>
</h4>
<ul>
<li>Intercept: Is mean length of <code>OJ:D0.5</code> = 0?
<ul>
<li>Low p-value, Reject null. Value is different from 0<br>
</li>
</ul>
</li>
<li>Is the difference of the treatment group different from our
reference group?
<ul>
<li>reference group in this case is: <code>OJ:D0.5</code><br>
</li>
<li>
<code>suppVC:doseD1</code> has a high p-value, failt to reject (FTR)
the null. In other words, it is not different from ’OJ:D0.5` (refer back
to box plot)<br>
</li>
<li>All other coefficients have p &lt; 0.05, so reject the null
hypothesis that those differences = 0. (In other words, there
<strong>IS</strong> a difference between means.)</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="tukeys-hsd">Tukey’s HSD<a class="anchor" aria-label="anchor" href="#tukeys-hsd"></a>
</h3>
<p>Before we run the Tukey HSD test, we need to run an ANOVA on our
linear model fit using the <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> function.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ANOVA of our lm model</span></span>
<span><span class="va">tooth_aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">tooth_lm</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tukey's test on the plant_aov object</span></span>
<span><span class="va">tooth_tukey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">tooth_aov</span><span class="op">)</span></span>
<span><span class="co"># print out results</span></span>
<span><span class="va">tooth_tukey</span></span></code></pre></div>
<pre><code><span><span class="co">##   Tukey multiple comparisons of means</span></span>
<span><span class="co">##     95% family-wise confidence level</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fit: aov(formula = tooth_lm)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $supp</span></span>
<span><span class="co">##       diff       lwr       upr     p adj</span></span>
<span><span class="co">## VC-OJ -3.7 -5.579828 -1.820172 0.0002312</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $dose</span></span>
<span><span class="co">##           diff       lwr       upr   p adj</span></span>
<span><span class="co">## D1-D0.5  9.130  6.362488 11.897512 0.0e+00</span></span>
<span><span class="co">## D2-D0.5 15.495 12.727488 18.262512 0.0e+00</span></span>
<span><span class="co">## D2-D1    6.365  3.597488  9.132512 2.7e-06</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`supp:dose`</span></span>
<span><span class="co">##                  diff        lwr        upr     p adj</span></span>
<span><span class="co">## VC:D0.5-OJ:D0.5 -5.25 -10.048124 -0.4518762 0.0242521</span></span>
<span><span class="co">## OJ:D1-OJ:D0.5    9.47   4.671876 14.2681238 0.0000046</span></span>
<span><span class="co">## VC:D1-OJ:D0.5    3.54  -1.258124  8.3381238 0.2640208</span></span>
<span><span class="co">## OJ:D2-OJ:D0.5   12.83   8.031876 17.6281238 0.0000000</span></span>
<span><span class="co">## VC:D2-OJ:D0.5   12.91   8.111876 17.7081238 0.0000000</span></span>
<span><span class="co">## OJ:D1-VC:D0.5   14.72   9.921876 19.5181238 0.0000000</span></span>
<span><span class="co">## VC:D1-VC:D0.5    8.79   3.991876 13.5881238 0.0000210</span></span>
<span><span class="co">## OJ:D2-VC:D0.5   18.08  13.281876 22.8781238 0.0000000</span></span>
<span><span class="co">## VC:D2-VC:D0.5   18.16  13.361876 22.9581238 0.0000000</span></span>
<span><span class="co">## VC:D1-OJ:D1     -5.93 -10.728124 -1.1318762 0.0073930</span></span>
<span><span class="co">## OJ:D2-OJ:D1      3.36  -1.438124  8.1581238 0.3187361</span></span>
<span><span class="co">## VC:D2-OJ:D1      3.44  -1.358124  8.2381238 0.2936430</span></span>
<span><span class="co">## OJ:D2-VC:D1      9.29   4.491876 14.0881238 0.0000069</span></span>
<span><span class="co">## VC:D2-VC:D1      9.37   4.571876 14.1681238 0.0000058</span></span>
<span><span class="co">## VC:D2-OJ:D2      0.08  -4.718124  4.8781238 1.0000000</span></span></code></pre>
<p>Here, we can see that we have a section for each factor as well as a
section for the interaction. Witin each section there is a row for every
pairwise combination. The table gives us an estimated and 95% CI for the
differences, as well as an adjusted p value.</p>
<p>We can also plot these differences. Any coefficient estimates which
cross zero are not considered to be significantly different.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tooth_tukey</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_12_2-way-anova_files/figure-html/unnamed-chunk-17-1.png" width="700"><img src="lab_12_2-way-anova_files/figure-html/unnamed-chunk-17-2.png" width="700"><img src="lab_12_2-way-anova_files/figure-html/unnamed-chunk-17-3.png" width="700"></p>
<div class="section level4">
<h4 id="coda">Coda<a class="anchor" aria-label="anchor" href="#coda"></a>
</h4>
<p>This concludes Lab 12, and you should now be able to complete the
homework assignment.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Justin Pomeranz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

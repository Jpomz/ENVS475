<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 05: Point Estimates and Confidence Intervals • ENVS475</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 05: Point Estimates and Confidence Intervals">
<meta property="og:description" content="ENVS475">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ENVS475</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2024.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fa fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fa fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-desktop"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/lecture_01/lecture_01.html">Lecture 01: Course introduction</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_03_basic-stats/lecture_03_basic-stats.html">Lecture 03: Basic Statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_05_estimation/lecture_05_estimation.html">Lecture 05: Point Estimates</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_06_intro-models/lecture_06_intro-models.html">Lecture 06: Intro to Models</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_07_t-tests/lecture_07_t-tests.html">Lecture 07: t-tests</a>
    </li>
    <li>
      <a href="../articles/lectures/lecture_10_anova/lecture_10_anova.html">Lecture 10: ANOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop-code"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab_01_projects.html">lab 01: projects</a>
    </li>
    <li>
      <a href="../articles/lab_02_intro_to_R.html">lab 02: Intro to R</a>
    </li>
    <li>
      <a href="../articles/lab_03_normal-distributions.html">lab 03: Normal Distributions</a>
    </li>
    <li>
      <a href="../articles/lab_04a_dplyr.html">lab 04a: dplyr</a>
    </li>
    <li>
      <a href="../articles/lab_04b_ggplot.html">lab 04b: ggplot</a>
    </li>
    <li>
      <a href="../articles/lab_05_point-estimates.html">lab 05: point estimates</a>
    </li>
    <li>
      <a href="../articles/lab_06_linear-models.html">lab 06: linear models</a>
    </li>
    <li>
      <a href="../articles/lab_08_t-tests.html">lab 07: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab_07_intro_markdown.html">lab 09: intro to R markdown</a>
    </li>
    <li>
      <a href="../articles/lab_10_anova.html">lab 10: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab_11_factorial-anova.html">lab 11: Factorial ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab_12_2-way-anova.html">lab 12: 2-way anova</a>
    </li>
    <li>
      <a href="../articles/lab_13_linear-regression.html">lab 13: Linear Regression</a>
    </li>
    <li>
      <a href="../articles/lab_14_ANCOVA.html">lab 14: ANCOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-folder-open"></span>
     
    Homework
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework/HW_01.html">Homework 01 setup</a>
    </li>
    <li>
      <a href="../articles/homework/HW_02_intro_R.html">Homework 02 Intro to R</a>
    </li>
    <li>
      <a href="../articles/homework/HW_03_normal-distributions.html">Homework 03 Normal Distributions</a>
    </li>
    <li>
      <a href="../articles/homework/HW_04_dplyr_ggplot.html">Homework 04 dplyr + ggplot2</a>
    </li>
    <li>
      <a href="../articles/homework/HW_05_point-estimates.html">Homework 05 Point Estimates</a>
    </li>
    <li>
      <a href="../articles/homework/HW_06_linear_models.html">Homework 06 Intro to Linear Models</a>
    </li>
    <li>
      <a href="../articles/homework/HW_07_t-tests.html">Homework 07 t-tests</a>
    </li>
    <li>
      <a href="../articles/homework/HW_09_markdown.html">Homework 09 R Markdown</a>
    </li>
    <li>
      <a href="../articles/homework/HW_10_ANOVA.html">Homework 10 ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_11_factorial.html">Homework 11 Factorial ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_12_two-way-ANOVA.html">Homework 12 2-way ANOVA</a>
    </li>
    <li>
      <a href="../articles/homework/HW_13_linear-regression.html">Homework 13 Linear Regression</a>
    </li>
    <li>
      <a href="../articles/homework/HW_14_ANCOVA.html">Homework 14 ANCOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/term-list.html">Terms and Definitions</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 05: Point Estimates and Confidence
Intervals</h1>
            <h3 data-toc-skip class="subtitle">ENVS475: Experimental
Analysis and Design</h3>
            
            <h4 data-toc-skip class="date">Spring, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Jpomz/ENVS475/blob/HEAD/vignettes/articles/lab_05_point-estimates.Rmd" class="external-link"><code>vignettes/articles/lab_05_point-estimates.Rmd</code></a></small>
      <div class="hidden name"><code>lab_05_point-estimates.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="about">About<a class="anchor" aria-label="anchor" href="#about"></a>
</h3>
<p>This lab will explore concepts of point estimates and confidence
intervals in R.</p>
</div>
<div class="section level3">
<h3 id="preliminaries">Preliminaries<a class="anchor" aria-label="anchor" href="#preliminaries"></a>
</h3>
<div class="section level4">
<h4 id="packages">Packages<a class="anchor" aria-label="anchor" href="#packages"></a>
</h4>
<p>For this lab, we will be using the <code>dplyr</code> and
<code>ggplot2</code> packages. Make sure both packages are installed on
your computer, and then run the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h4>
<p>For this lab, we will be using the <code>body_temp_hr.csv</code>
data. You can download the csv file from D2L. Be sure to put it into
your <code>data/</code> folder. When we read in the data, we will assign
it to the object called <code>bt_samp</code> which stands for “body
temperature sample”.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"data/body_temp_hr.csv"</span><span class="op">)</span></span></code></pre></div>
<p>You should always look at the data after you load it:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bt_samp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 130   3</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bt_samp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">##   body_temp sex   heart_rate</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>      96.3 male          70</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>      96.7 male          71</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>      96.9 male          74</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>      97   male          80</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>      97.1 male          73</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>      97.1 male          75</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bt_samp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    body_temp          sex              heart_rate   </span></span>
<span><span class="co">##  Min.   : 96.30   Length:130         Min.   :57.00  </span></span>
<span><span class="co">##  1st Qu.: 97.80   Class :character   1st Qu.:69.00  </span></span>
<span><span class="co">##  Median : 98.30   Mode  :character   Median :74.00  </span></span>
<span><span class="co">##  Mean   : 98.25                      Mean   :73.76  </span></span>
<span><span class="co">##  3rd Qu.: 98.70                      3rd Qu.:79.00  </span></span>
<span><span class="co">##  Max.   :100.80                      Max.   :89.00</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bt_samp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "body_temp"  "sex"        "heart_rate"</span></span></code></pre>
<p>This data contains 130 observations of individual body temperatures
and heart rates for patients. It also indicates the biological sex of
the patient.</p>
</div>
</div>
<div class="section level2">
<h2 id="one-sample">One sample<a class="anchor" aria-label="anchor" href="#one-sample"></a>
</h2>
<p>For this exercise, we will be focusing on the <code>body_temp</code>
variable.</p>
<div class="section level3">
<h3 id="data-distribution">Data distribution<a class="anchor" aria-label="anchor" href="#data-distribution"></a>
</h3>
<p>First, let’s make a histogram and density plot of the data to see if
it looks normal.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">bt_samp</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_temp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_05_point-estimates_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">bt_samp</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_temp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_05_point-estimates_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>This data looks a little skewed. There’s a bit of a “hump” to the
left side, and a couple of really large (high temperatures) in 100-101
range. However, this is probably close enough that we can use a normal
approximation.</p>
</div>
<div class="section level3">
<h3 id="descriptive-statistics">Descriptive Statistics<a class="anchor" aria-label="anchor" href="#descriptive-statistics"></a>
</h3>
<p>Let’s first calculate descriptive statistics (mean and standard
deviation) for the sample of body temperatures. We will store them in
new variables called <code>bt_mean</code> and <code>bt_sd</code>
respectively. We repeat the call to the objects below to have R print
out their values.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">bt_samp</span><span class="op">$</span><span class="va">body_temp</span><span class="op">)</span></span>
<span><span class="va">bt_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">bt_samp</span><span class="op">$</span><span class="va">body_temp</span><span class="op">)</span></span>
<span><span class="va">bt_mean</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 98.24923</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_sd</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.7331832</span></span></code></pre>
<p>With this information, we can write out the mean (<span class="math inline">\(\pm\)</span> SD), rounded to one decimal place.
&gt; Our data indicates that the average temperature was 98.2 <span class="math inline">\(\pm\)</span> 0.73 (mean <span class="math inline">\(\pm 1 SD\)</span>)</p>
</div>
<div class="section level3">
<h3 id="inferential-statistics">Inferential Statistics<a class="anchor" aria-label="anchor" href="#inferential-statistics"></a>
</h3>
<p>How confident are we in this average? In order to do that, we can
calculate the standard error of the mean, SEM. Unfortunately, there is
no built in function to calculate SE in R. But recall that the formula
for SEM is:</p>
<p><span class="math display">\[\large SEM =
\frac{s}{\sqrt{n}}\]</span></p>
<p>We already have <span class="math inline">\(s\)</span> stored in the
<code>bt_sd</code> object. Now we just need to calculate <span class="math inline">\(\sqrt(n)\)</span>. The <code><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt()</a></code>
function can be used to calculate the square root, but how do we get
<span class="math inline">\(n\)</span>?</p>
<p>Because there are no <code>NA</code> values in the
<code>body_temp</code> variable, we can use the <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code>
function to get the number of observations. You might be tempted to
enter the following to get <span class="math inline">\(n\)</span>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bt_samp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3</span></span></code></pre>
<p>However, the <code>bt_samp</code> object is a
<code>data.frame</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">bt_samp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "spec_tbl_df" "tbl_df"      "tbl"         "data.frame"</span></span></code></pre>
<p>And the default behavior for <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code> when used on a
data frame is to give the number of columns. We need to supply a
<code>vector</code> in order to get the number of observations. We can
accomplish this by subsetting the data frame to just the
<code>body_temp</code> variable using the <code>$</code> syntax.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bt_samp</span><span class="op">$</span><span class="va">body_temp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 130</span></span></code></pre>
<p>Let’s calculate the SEM of body temperature and call it
<code>bt_sem</code>. But first, lets store the number of observations in
this data as <code>bt_n</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bt_samp</span><span class="op">$</span><span class="va">body_temp</span><span class="op">)</span></span>
<span><span class="va">bt_sem</span> <span class="op">&lt;-</span> <span class="va">bt_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">bt_n</span><span class="op">)</span></span>
<span><span class="va">bt_sem</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.06430442</span></span></code></pre>
<p>So the mean body temperature is estimated to be 98.2 <span class="math inline">\(\pm\)</span> 0.1 (mean <span class="math inline">\(\pm\)</span> SEM).</p>
<p>We can also calculate the full interval as:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bt_mean</span> <span class="op">-</span> <span class="va">bt_sem</span>, <span class="va">bt_mean</span> <span class="op">+</span> <span class="va">bt_sem</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 98.185 98.314</span></span></code></pre>
<p>Recall that we use the <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> to combine multiple values
into a single vector. Note I also used the <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">round()</a></code> function
to simplify the output.</p>
<p>As a bit of review, we can do the same thing using pipes, which may
or may not be easier at this point than reading the functions “inside
out”:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bt_mean</span> <span class="op">-</span> <span class="va">bt_sem</span>, <span class="va">bt_mean</span> <span class="op">+</span> <span class="va">bt_sem</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 98.185 98.314</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="confidence-intervals">Confidence Intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals"></a>
</h3>
<p>Assuming that our data is from a normal distribution, 95% Confidence
intervals can approximated with the following equation:</p>
<p><span class="math display">\[\large 95\%CI =\bar{y} \pm
2*SEM\]</span></p>
<p>We can estimate the lower and upper limit of the 95% CI in R with the
following:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_mean</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">bt_sem</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 98.12062</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_mean</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">bt_sem</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 98.37784</span></span></code></pre>
<p>Therefore, the data supports, with 95% confidence, that the mean body
temperature is within 98.121 and 98.38 degrees Fahrenheit.</p>
<p>Once again, we can use <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> to have the full interval
print out as one vector:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bt_mean</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">bt_sem</span>, <span class="va">bt_mean</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">bt_sem</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 98.12062 98.37784</span></span></code></pre>
<div class="section level4">
<h4 id="changing-the-confidence-level">Changing the confidence level<a class="anchor" aria-label="anchor" href="#changing-the-confidence-level"></a>
</h4>
<p>We can change the confidence level of our estimate by modifying the
“2” value above. Briefly, recall that the empirical rule states that
~95% of the observed data falls within 2 standard deviations of the
sample. Here, we are not comparing observations and sample means, but
instead comparing sample means with the true mean. (We will explore the
distribution of sample means more below.) However, the same general
pattern applies. Namely, that 95% of the sample means falls within 2
standard deviations of the true mean.</p>
<p>Also recall that ~99% falls within 3 standard deviations. So, we can
calculate a 99% CI by changing the 2 to a 3 in the equation above:</p>
<p><span class="math display">\[\large 99\%CI =\bar{y} \pm
3*SEM\]</span><br>
Likewise in R:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_mean</span> <span class="op">-</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">bt_sem</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 98.05632</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_mean</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">bt_sem</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 98.44214</span></span></code></pre>
<p>So we can estimate, with 99% confidence, that the mean body
temperature lies within the range of 98.056 and 98.442.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="testing-hypotheses-with-cis">Testing Hypotheses with CIs<a class="anchor" aria-label="anchor" href="#testing-hypotheses-with-cis"></a>
</h2>
<p>You might be familiar with the popular notion that average body
temperature is around 98.6 degrees Fahrenheit. Based on the 95 and 99%
confidence intervals calculated above, what can we say about this
hypothesis?</p>
<p>Formally (more on formal hypotheses later in class):</p>
<p><span class="math display">\[H_0: \mu = 98.6^\circ
~Fahrenheit\]</span> <span class="math display">\[H_A: \mu \ne
98.6^\circ ~Fahrenheit\]</span></p>
<p><strong>95% CI Interpretation</strong>: Based on the data, with 95%
confidence, the interval of average body temperature does not include
98.6 degrees. Therefore, we can reject the null hypothesis (<span class="math inline">\(H_0\)</span>) and accept the alternative that the
true mean of the population does not equal 98.6 degrees.</p>
<p><strong>99% CI interpretation</strong>: Complete this interpretation
based on the 99% Confidence Interval on your own.</p>
<div class="section level3">
<h3 id="comparing-two-cis">Comparing two CIs<a class="anchor" aria-label="anchor" href="#comparing-two-cis"></a>
</h3>
<p>In the above, we were just interested to see if a specific value
(98.6) was within our interval. We can also compare the 95% confidence
interval for the means of two different groups.</p>
<p>Below is a plot of CIs from three different scenarios. These are
basic “rules of thumb”. We will get into more formal analyses and
calculate exact p-values in future classes.</p>
<p>A. Means are definitely different (i.e., low p-value)</p>
<ul>
<li>intervals are completely outside of each other</li>
</ul>
<p>B. Means are different (p-value &lt; 0.05, but maybe not much
less).</p>
<ul>
<li>Edges of CIs overlap slightly, but means are pretty far away from
each other.</li>
</ul>
<p>C. Means are <strong>NOT</strong> different.</p>
<ul>
<li>Means are close together, much overlap in CIs.</li>
</ul>
<p><img src="lab_05_point-estimates_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="point-estimates-with-dplyr">Point estimates with <code>dplyr</code><a class="anchor" aria-label="anchor" href="#point-estimates-with-dplyr"></a>
</h2>
<p>Let’s say that we are interested in comparing the mean body
temperatures between males and females in this data set. We could split
the data and perform all of the same tasks above on each data frame.
Alternatively, we could harness the power of <code>dplyr</code> and
calculate everything in a few short steps. For the following example, I
will only be calcualting the 95% confidence interval.</p>
<p>The steps will break down to the following:<br>
1. group the data based on <code>sex</code><br>
2. Calculate summary statistics using <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code> and
<code><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd()</a></code> inside of a <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise()</a></code> function<br>
3. <code>mutate</code> the summarized data to calculate 95 and 99%
confidence intervals.<br>
4. select only variables of interest<br>
5. Plot confidence intervals in <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code></p>
<p>But first, I’m going to make <code>bt_samp</code> a tibble to shorten
the display output in this lab.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_samp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 130 × 3</span></span></span>
<span><span class="co">##    body_temp sex   heart_rate</span></span>
<span><span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>      96.3 male          70</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>      96.7 male          71</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>      96.9 male          74</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>      97   male          80</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>      97.1 male          73</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>      97.1 male          75</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>      97.1 male          82</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>      97.2 male          64</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>      97.3 male          69</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>      97.4 male          70</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 120 more rows</span></span></span></code></pre>
<p>Now I’m going to perform steps 1-3 one at a time in the following
code blocks.<br>
* I’m presenting these blocks one at a time to emphasize the iterative
process when figuring out to code your problems<br>
* in reality, I would run these and build upon each step, but my final
script would just have one call to perform the whole thing</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># step 1, group the data by sex</span></span>
<span><span class="va">bt_samp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 130 × 3</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   sex [2]</span></span></span>
<span><span class="co">##    body_temp sex   heart_rate</span></span>
<span><span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>      96.3 male          70</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>      96.7 male          71</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>      96.9 male          74</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>      97   male          80</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>      97.1 male          73</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>      97.1 male          75</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>      97.1 male          82</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>      97.2 male          64</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>      97.3 male          69</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>      97.4 male          70</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 120 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># step 2 summarize the data</span></span>
<span><span class="va">bt_samp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>mean_bt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">body_temp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            sd_bt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">body_temp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            n_bt <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">##   sex    mean_bt sd_bt  n_bt</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> female    98.4 0.743    65</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> male      98.1 0.699    65</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># step 3, calculate SEM and CI's</span></span>
<span><span class="co"># be sure to match new variable names that you created</span></span>
<span><span class="va">bt_samp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>mean_bt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">body_temp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            sd_bt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">body_temp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            n_bt <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sem <span class="op">=</span> <span class="va">sd_bt</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n_bt</span><span class="op">)</span>,</span>
<span>         ci95_low <span class="op">=</span> <span class="va">mean_bt</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">sem</span>,</span>
<span>         ci95_high <span class="op">=</span> <span class="va">mean_bt</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">sem</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">##   sex    mean_bt sd_bt  n_bt    sem ci95_low ci95_high</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> female    98.4 0.743    65 0.092<span style="text-decoration: underline;">2</span>     98.2      98.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> male      98.1 0.699    65 0.086<span style="text-decoration: underline;">7</span>     97.9      98.3</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># step 4, select CI variables and save into a new object for plotting</span></span>
<span><span class="va">bt_sex</span> <span class="op">&lt;-</span> <span class="va">bt_samp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>mean_bt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">body_temp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            sd_bt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">body_temp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            n_bt <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sem <span class="op">=</span> <span class="va">sd_bt</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n_bt</span><span class="op">)</span>,</span>
<span>         ci95_low <span class="op">=</span> <span class="va">mean_bt</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">sem</span>,</span>
<span>         ci95_high <span class="op">=</span> <span class="va">mean_bt</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">sem</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sex</span>, <span class="va">ci95_low</span>, <span class="va">mean_bt</span>, <span class="va">ci95_high</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print out the new object so we can see the values</span></span>
<span><span class="va">bt_sex</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">##   sex    ci95_low mean_bt ci95_high</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> female     98.2    98.4      98.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> male       97.9    98.1      98.3</span></span></code></pre>
<p>Draw a number line and mark the mean and the lower and upper
confidence intervals for each group. Do the confidence interval overlap?
At the 95% confidence level, what can we say about the average body
temperatures for males and females based on this data?</p>
<p>Now let’s use ggplot to display these confidence intervals.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># step 5, plot point estimates</span></span>
<span><span class="va">bt_sex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">sex</span>,</span>
<span>           x <span class="op">=</span> <span class="va">mean_bt</span>,</span>
<span>           xmin <span class="op">=</span> <span class="va">ci95_low</span>, </span>
<span>           xmax <span class="op">=</span> <span class="va">ci95_high</span>,</span>
<span>           color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_pointrange</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Average body temperature"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"95% CIs for average body temperature."</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_05_point-estimates_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>How would you interpret this result? Look at the “Rules of thumb”
plot above as a guideline.</p>
<p>You may have realized that this is close to our two different rules,
CI’s only overlap a little bit, but the means are quite close together.
This is a case that may be too close to call based on our rules of
thumb. Here we would likely need to run a more formal hypothesis test
such as Student’s t-test.</p>
<p>Just in case you’re wondering, here is the results of a simple
t-test.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">body_temp</span> <span class="op">~</span> <span class="va">sex</span>,</span>
<span>       var.equal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>       alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>       data <span class="op">=</span> <span class="va">bt_samp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Two Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  body_temp by sex</span></span>
<span><span class="co">## t = 2.2854, df = 128, p-value = 0.02393</span></span>
<span><span class="co">## alternative hypothesis: true difference in means between group female and group male is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.03882216 0.53963938</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean in group female   mean in group male </span></span>
<span><span class="co">##             98.39385             98.10462</span></span></code></pre>
<p>Here, a p-value of 0.02 is less than <span class="math inline">\(\alpha = 0.05\)</span> so this difference in
temperature <em>IS</em> significant. Don’t worry if you don’t remember
all these details right now, we will come to this in due course.</p>
</div>
<div class="section level2">
<h2 id="repeated-experiments-simulation-optional">Repeated Experiments: Simulation (Optional)<a class="anchor" aria-label="anchor" href="#repeated-experiments-simulation-optional"></a>
</h2>
<div class="section level5">
<h5 id="note-the-following-section-is-optional-for-those-interested-in-exploring-how-to-simulate-repeated-experimental-observations-">
<strong>NOTE The following section is optional for those interested
in exploring how to simulate repeated experimental
observations.</strong><a class="anchor" aria-label="anchor" href="#note-the-following-section-is-optional-for-those-interested-in-exploring-how-to-simulate-repeated-experimental-observations-"></a>
</h5>
</div>
<div class="section level5">
<h5 id="this-will-not-be-on-the-homework-and-is-supplied-for-your-personal-edification-only">
<strong>This will not be on the homework and is supplied for your
personal edification only</strong><a class="anchor" aria-label="anchor" href="#this-will-not-be-on-the-homework-and-is-supplied-for-your-personal-edification-only"></a>
</h5>
<p>In order to explore the distribution of sample means in greater
detail, let’s repeat the above experiment by sampling 130 random
observations of temperature from a hypothetical population.</p>
<p>Let’s assume that the mean and SD for the original sample are the
“true parameters” i.e., <span class="math inline">\(\mu\)</span> =
98.2492308 and <span class="math inline">\(\sigma\)</span> = 0.7331832.
This is most certainly not the case, but it’s a good enough estimate for
now.</p>
<p>In order to draw a new sample from this distribution, we can use the
<code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm()</a></code> function. Type in <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">?rnorm</a></code> to pull up
the help page for this function.</p>
<p>Note that the arguments are <code>n</code>, <code>mean</code>, and
<code>sd</code>. We can enter numbers for these arguments, or we can use
the objects that we’ve already saved.</p>
<p>Recall the values stored in each of these objects:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_n</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 130</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_mean</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 98.24923</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_sd</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.7331832</span></span></code></pre>
<p>In order to draw a new sample of observations, we can enter the
following:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">444</span><span class="op">)</span></span>
<span><span class="va">new_bt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">bt_n</span>, mean <span class="op">=</span> <span class="va">bt_mean</span>, sd <span class="op">=</span> <span class="va">bt_sd</span><span class="op">)</span></span></code></pre></div>
<p>Note that the <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> function fixes the random
number generator for consistency. They are still “random” numbers, but
we will get the same sequence of random numbers every time, as long as
we run the <code>set.seed(444)</code> each time.</p>
<p>As an example, run the following code a few times:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>And now try the following a few times:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">444</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Back to our new sample. We can calculate the mean, sd, SEM, and 95%CI
of our new sample as follows:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">new_bt</span><span class="op">)</span></span>
<span><span class="va">new_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">new_bt</span><span class="op">)</span></span>
<span><span class="va">new_sem</span> <span class="op">&lt;-</span> <span class="va">new_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">new_bt</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">new_mean</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 98.20756</span></span></code></pre>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_sd</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.7073895</span></span></code></pre>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_sem</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.06204216</span></span></code></pre>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 95% CI</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">new_mean</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">new_sem</span>, <span class="va">new_mean</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">new_sem</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 98.08348 98.33164</span></span></code></pre>
<p>We can see there is some variation in these estimates, but that they
are relatively similar.</p>
<p>Now, we could keep doing the above over and over again to get a
distribution of samples, but that would require lots of typing, and
almost certainly we would make a number of errors.</p>
<p>Instead, we can use the power of R to automate this for us with
minimal typing. Don’t worry too much about what the code below is doing.
Essentially, I’m going to use a “for loop” to repeat our sampling
procedure 100 times. If you have any questions about this process or
want to learn more, please ask me during open class times, or come to my
office.</p>
</div>
<div class="section level4">
<h4 id="replicate-experiment-100-times">Replicate experiment 100 times<a class="anchor" aria-label="anchor" href="#replicate-experiment-100-times"></a>
</h4>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set.seed so we all have the same numbers</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2562</span><span class="op">)</span></span>
<span><span class="co"># define our variables</span></span>
<span><span class="va">true_mean</span> <span class="op">&lt;-</span> <span class="va">bt_mean</span></span>
<span><span class="va">true_sd</span> <span class="op">&lt;-</span> <span class="va">bt_sd</span></span>
<span><span class="va">obs_n</span> <span class="op">&lt;-</span> <span class="fl">130</span></span>
<span></span>
<span><span class="co"># make a dataframe called "samp" to hold our simulation estimates</span></span>
<span><span class="va">samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Experiment <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>                   Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                   SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># repeat sample 100 times</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">obs_n</span>, <span class="va">true_mean</span>, <span class="va">true_sd</span><span class="op">)</span></span>
<span>  <span class="va">samp</span><span class="op">$</span><span class="va">Estimate</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">samp</span><span class="op">$</span><span class="va">SD</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">samp</span><span class="op">$</span><span class="va">SEM</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">obs_n</span><span class="op">)</span></span>
<span>  <span class="va">samp</span><span class="op">$</span><span class="va">true_mean</span> <span class="op">=</span> <span class="va">true_mean</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We now have a new object called <code>samp</code> in our R
environment which has the “experiment” replicate (from 1 to 100). And
for each experiment we have a mean, sd, and SEM. Notice I also repeated
the “true_mean” value. This is for use in <code>ggplot</code> a few
steps below. Now, we can use the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> function from
<code>dplyr</code> to add estimates of our lower and upper confidence
interval values.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># overwrite the old "samp" to include our new variables</span></span>
<span></span>
<span><span class="va">samp</span> <span class="op">&lt;-</span> <span class="va">samp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Estimate is the mean for our sample</span></span>
<span>    LCI <span class="op">=</span> <span class="va">Estimate</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">SEM</span>, <span class="co"># Lower CI</span></span>
<span>    UCI <span class="op">=</span> <span class="va">Estimate</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">SEM</span>, <span class="co"># Upper CI</span></span>
<span>    Color <span class="op">=</span> <span class="co"># make a categorical value </span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">LCI</span> <span class="op">&lt;=</span><span class="va">true_mean</span> <span class="op">&amp;</span> <span class="va">UCI</span> <span class="op">&gt;=</span> <span class="va">true_mean</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># print out head() of new "samp" to see new variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Experiment Estimate SE        SD        SEM true_mean      LCI      UCI Color</span></span>
<span><span class="co">## 1          1 98.23382  0 0.7490101 0.06420672  98.24923 98.10540 98.36223   Yes</span></span>
<span><span class="co">## 2          2 98.36406  0 0.6497228 0.06420672  98.24923 98.23565 98.49248   Yes</span></span>
<span><span class="co">## 3          3 98.19651  0 0.6653367 0.06420672  98.24923 98.06810 98.32492   Yes</span></span>
<span><span class="co">## 4          4 98.24108  0 0.7983420 0.06420672  98.24923 98.11267 98.36949   Yes</span></span>
<span><span class="co">## 5          5 98.27288  0 0.8196224 0.06420672  98.24923 98.14447 98.40129   Yes</span></span>
<span><span class="co">## 6          6 98.22478  0 0.7159369 0.06420672  98.24923 98.09637 98.35319   Yes</span></span></code></pre>
<p>Now, we can use <code>ggplot</code> to illustrate which confidence
intervals from our repeated experiments had the “true mean” within
them.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">samp</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Experiment</span>,</span>
<span>           y <span class="op">=</span> <span class="va">Estimate</span>, </span>
<span>           ymin <span class="op">=</span> <span class="va">LCI</span>,</span>
<span>           ymax <span class="op">=</span> <span class="va">UCI</span>,</span>
<span>           color <span class="op">=</span> <span class="va">Color</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_pointrange</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add reference line for "true" mean</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span></span>
<span>    yintercept <span class="op">=</span> <span class="va">true_mean</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab_05_point-estimates_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
<p>Here, we hav 96/100 samples which have the “true” mean which is close
to our approximated 95% CI.</p>
</div>
<div class="section level4">
<h4 id="coda">Coda<a class="anchor" aria-label="anchor" href="#coda"></a>
</h4>
<p>You should now be able to complete the homework for this week.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Justin Pomeranz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
